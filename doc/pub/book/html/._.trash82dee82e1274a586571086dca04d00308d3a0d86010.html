<!--
Automatically generated HTML file from DocOnce source
(https://github.com/hplgit/doconce/)
-->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="DocOnce: https://github.com/hplgit/doconce/" />
<meta name="description" content="Finite Difference Computing with Exponential Decay Models">
<meta name="keywords" content="decay ODE,exponential decay,mesh,grid,mesh function,finite differences,forward difference,finite differences forward,difference equation,discrete equation,algebraic equation,finite difference scheme,Forward Euler scheme,backward difference,finite differences backward,backward scheme, 1-step,Backward Euler scheme,Crank-Nicolson scheme,centered difference,finite differences centered,averaging arithmetic,weighted average,theta-rule,$\theta$-rule,time step,finite difference operator notation,operator notation, finite differences,directory,folder,doc strings,printf format,format string syntax (Python),plotting curves,visualizing curves,representative (mesh function),array arithmetics,array computing,vectorization,continuous function norms,norm continuous,discrete function norms,mesh function norms,norm discrete (mesh function),error norms,scalar computing,PNG plot,PDF plot,EPS plot,viewing graphics files,cropping images,array arithmetics,array computing,vectorization,stability,amplification factor,A-stable methods,L-stable methods,interactive Python,error amplification factor,error global,consistency,stability,convergence,Monte Carlo simulation,lambda functions,method of manufactured solutions,MMS (method of manufactured solutions),convergence rate,verification,implicit schemes,explicit schemes,theta-rule,$\theta$-rule,backward scheme, 2-step,BDF2 scheme,Leapfrog scheme,Leapfrog scheme, filtered,Heun's method,Runge-Kutta, 2nd-order method,Taylor-series methods (for ODEs),Adams-Bashforth scheme, 2nd-order,Adams-Bashforth scheme, 3rd order,Runge-Kutta, 4th-order method,RK4,adaptive time stepping,Dormand-Prince Runge-Kutta 4-5 method,population dynamics,logistic model,radioactive decay,chemical reactions irreversible,chemical reactions reversible,Lotka-Volterra model,predator-prey model,terminal velocity,geometric mean,averaging geometric,scaling,Kelvin-Voigt material model,viscoelasticity,refactoring,importing modules,logger,debugging,list comprehension,command-line arguments,option-value pairs (command line),command-line arguments,reading the command line,doctests,software testing doctests,unit testing,software testing nose,software testing pytest,test function,software testing test function,doctest in test function,unit testing,software testing unit testing (class-based),Distutils,GitHub,importing modules,problem class,solver class,wrapper (code),reproducibility,replicability,Unix wildcard notation,wildcard notation (Unix),Word (Microsoft),LibreOffice,OpenOffice,Google Docs,HTML,MathJax,LaTeX,Sphinx (typesetting tool),Markdown,IPython notebooks,Jupyter notebooks,DocOnce,replicability">

<title>Finite Difference Computing with Exponential Decay Models</title>

<!-- Bootstrap style: bootswatch_readable -->
<link href="http://netdna.bootstrapcdn.com/bootswatch/3.1.1/readable/bootstrap.min.css" rel="stylesheet">
<!-- not necessary
<link href="http://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
-->

<style type="text/css">
/* Let inline verbatim have the same color as the surroundings */
code { color: inherit; background-color: transparent; }

/*
in.collapse+a.btn.showdetails:before { content:'Hide details'; }
.collapse+a.btn.showdetails:before { content:'Show details'; }
*/
</style>


</head>

<!-- tocinfo
{'highest level': 0,
 'sections': [('Preface', 0, 'ch:preface', 'ch:preface'),
              ('Acknowledgments', 3, None, '___sec1'),
              ('Algorithms and implementations', 0, None, '___sec2'),
              ('Finite difference methods',
               1,
               'decay:basics',
               'decay:basics'),
              ('A basic model for exponential decay',
               2,
               'decay:model',
               'decay:model'),
              ('The exact solution', 3, None, '___sec5'),
              ('A complete problem formulation', 3, None, '___sec6'),
              ('The Forward Euler scheme',
               2,
               'decay:schemes:FE',
               'decay:schemes:FE'),
              ('Step 1: Discretizing the domain', 3, None, '___sec8'),
              ('Step 2: Fulfilling the equation at discrete time points',
               3,
               None,
               '___sec9'),
              ('Step 3: Replacing derivatives by finite differences',
               3,
               None,
               '___sec10'),
              ('Step 4: Formulating a recursive algorithm',
               3,
               None,
               '___sec11'),
              ('Interpretation', 3, None, '___sec12'),
              ('Computing with the recursive formula', 3, None, '___sec13'),
              ('The Backward Euler scheme',
               2,
               'decay:schemes:BE',
               'decay:schemes:BE'),
              ('The Crank-Nicolson scheme',
               2,
               'decay:schemes:CN',
               'decay:schemes:CN'),
              ('The unifying $\\theta$-rule',
               2,
               'decay:schemes:theta',
               'decay:schemes:theta'),
              ('Constant time step', 2, None, '___sec17'),
              ('Mathematical derivation of finite difference formulas',
               2,
               'decay:fd:taylor',
               'decay:fd:taylor'),
              ('The forward difference', 3, None, '___sec19'),
              ('The backward difference', 3, None, '___sec20'),
              ('The centered difference', 3, None, '___sec21'),
              ('Compact operator notation for finite differences',
               2,
               'decay:fd:op',
               'decay:fd:op'),
              ('Implementation', 1, 'decay:impl1', 'decay:impl1'),
              ('Computer language: Python', 2, None, '___sec24'),
              ('Making a solver function', 2, 'decay:py1', 'decay:py1'),
              ('Integer division', 2, 'decay:py2', 'decay:py2'),
              ('Doc strings', 2, None, '___sec27'),
              ('Formatting numbers', 2, None, '___sec28'),
              ('Running the program', 2, None, '___sec29'),
              ('Plotting the solution', 2, None, '___sec30'),
              ('Verifying the implementation', 2, None, '___sec31'),
              ('Running a few algorithmic steps by hand',
               3,
               None,
               '___sec32'),
              ('Computing the numerical error as a mesh function',
               2,
               'decay:computing:error',
               'decay:computing:error'),
              ('Computing the norm of the error mesh function',
               2,
               'decay:computing:error:norm',
               'decay:computing:error:norm'),
              ('Scalar computing', 3, None, '___sec35'),
              ('Experiments with computing and plotting',
               2,
               None,
               '___sec36'),
              ('Combining plot files', 3, None, '___sec37'),
              ('Plotting with SciTools', 3, None, '___sec38'),
              ('Memory-saving implementation', 2, None, '___sec39'),
              ('Exercises', 1, None, '___sec40'),
              ('Exercise 1: Define a mesh function and visualize it',
               2,
               'decay:exer:meshfunc',
               'decay:exer:meshfunc'),
              ('Remarks', 3, None, '___sec42'),
              ('Problem 2: Differentiate a function',
               2,
               'decay:exer:dudt',
               'decay:exer:dudt'),
              ('Problem 3: Experiment with divisions',
               2,
               'decay:exer:intdiv',
               'decay:exer:intdiv'),
              ('Problem 4: Experiment with wrong computations',
               2,
               'decay:exer:decay1err',
               'decay:exer:decay1err'),
              ('Problem 5: Plot the error function',
               2,
               'decay:exer:plot:error',
               'decay:exer:plot:error'),
              ('Problem 6: Change formatting of numbers and debug',
               2,
               'decay:exer:inexact:output',
               'decay:exer:inexact:output'),
              ('Analysis', 0, 'decay:analysis', 'decay:analysis'),
              ('Experimental investigations', 1, None, '___sec49'),
              ('Discouraging numerical solutions', 2, None, '___sec50'),
              ('Detailed experiments', 2, None, '___sec51'),
              ('Stability', 1, None, '___sec52'),
              ('Exact numerical solution', 2, None, '___sec53'),
              ('Stability properties derived from the amplification factor',
               2,
               None,
               '___sec54'),
              ('Accuracy', 1, None, '___sec55'),
              ('Visual comparison of amplification factors',
               2,
               None,
               '___sec56'),
              ('Series expansion of amplification factors',
               2,
               None,
               '___sec57'),
              ('The ratio of numerical and exact amplification factors',
               2,
               None,
               '___sec58'),
              ('The global error at a point',
               2,
               'decay:analysis:gobal:error',
               'decay:analysis:gobal:error'),
              ('Integrated error',
               2,
               'decay:analysis:gobal:error_int',
               'decay:analysis:gobal:error_int'),
              ('Truncation error',
               2,
               'decay:analysis:trunc',
               'decay:analysis:trunc'),
              ('Consistency, stability, and convergence',
               2,
               None,
               '___sec62'),
              ('Various types of errors in a differential equation model',
               1,
               None,
               '___sec63'),
              ('Model errors', 2, None, '___sec64'),
              ('Data errors', 2, None, '___sec65'),
              ('Discretization errors', 2, None, '___sec66'),
              ('Rounding errors', 2, None, '___sec67'),
              ('Discussion of the size of various errors',
               2,
               None,
               '___sec68'),
              ('Exercises', 1, None, '___sec69'),
              ('Problem 7: Visualize the accuracy of finite differences',
               2,
               'decay:analysis:exer:fd:exp:plot',
               'decay:analysis:exer:fd:exp:plot'),
              ('Problem 8: Explore the $\\theta$-rule for exponential growth',
               2,
               'decay:analysis:exer:growth',
               'decay:analysis:exer:growth'),
              ('Problem 9: Explore rounding errors in numerical calculus',
               2,
               'decay:analysis:exer:rounding',
               'decay:analysis:exer:rounding'),
              ('Generalizations', 0, None, '___sec73'),
              ('Model extensions', 1, None, '___sec74'),
              ('Generalization: including a variable coefficient',
               2,
               None,
               '___sec75'),
              ('Generalization: including a source term',
               2,
               'decay:source',
               'decay:source'),
              ('Implementation of the generalized model problem',
               2,
               'decay:general',
               'decay:general'),
              ('Deriving the $\\theta$-rule formula', 3, None, '___sec78'),
              ('Python code', 3, None, '___sec79'),
              ('Coding of variable coefficients', 3, None, '___sec80'),
              ('Verifying a constant solution',
               2,
               'decay:verify:trivial',
               'decay:verify:trivial'),
              ('Verification via manufactured solutions',
               2,
               'decay:MMS',
               'decay:MMS'),
              ('Computing convergence rates',
               2,
               'decay:convergence:rate',
               'decay:convergence:rate'),
              ('Estimating $r$', 3, None, '___sec84'),
              ('Implementation', 3, None, '___sec85'),
              ('Extension to systems of ODEs', 2, None, '___sec86'),
              ('General first-order ODEs', 1, None, '___sec87'),
              ('Generic form of first-order ODEs', 2, None, '___sec88'),
              ('The $\\theta$-rule', 2, None, '___sec89'),
              ('An implicit 2-step backward scheme', 2, None, '___sec90'),
              ('Leapfrog schemes', 2, None, '___sec91'),
              ('The ordinary Leapfrog scheme', 3, None, '___sec92'),
              ('The filtered Leapfrog scheme', 3, None, '___sec93'),
              ('The 2nd-order Runge-Kutta method', 2, None, '___sec94'),
              ('A 2nd-order Taylor-series method', 2, None, '___sec95'),
              ('The 2nd- and 3rd-order Adams-Bashforth schemes',
               2,
               None,
               '___sec96'),
              ('The 4th-order Runge-Kutta method',
               2,
               'decay:fd2:RK4',
               'decay:fd2:RK4'),
              ('The Odespy software', 2, None, '___sec98'),
              ('Example: Runge-Kutta methods', 2, None, '___sec99'),
              ('Remark about using the $\\theta$-rule in Odespy',
               3,
               None,
               '___sec100'),
              ('Example: Adaptive Runge-Kutta methods',
               2,
               'decay:fd2:adaptiveRK',
               'decay:fd2:adaptiveRK'),
              ('Exercises', 1, None, '___sec102'),
              ('Exercise 10: Experiment with precision in tests and the size of $u$',
               2,
               'decay:fd2:exer:precision',
               'decay:fd2:exer:precision'),
              ('Exercise 11: Implement the 2-step backward scheme',
               2,
               'decay:fd2:exer:bw2',
               'decay:fd2:exer:bw2'),
              ('Exercise 12: Implement the 2nd-order Adams-Bashforth scheme',
               2,
               'decay:fd2:exer:AB2',
               'decay:fd2:exer:AB2'),
              ('Exercise 13: Implement the 3rd-order Adams-Bashforth scheme',
               2,
               'decay:fd2:exer:AB3',
               'decay:fd2:exer:AB3'),
              ('Exercise 14: Analyze explicit 2nd-order methods',
               2,
               'decay:exer:RK2:Taylor:analysis',
               'decay:exer:RK2:Taylor:analysis'),
              ('Project 15: Implement and investigate the Leapfrog scheme',
               2,
               'decay:fd2:exer:leapfrog1',
               'decay:fd2:exer:leapfrog1'),
              ('Problem 16: Make a unified implementation of many schemes',
               2,
               'decay:fd2:exer:uni',
               'decay:fd2:exer:uni'),
              ('Models', 0, 'decay:app', 'decay:app'),
              ('Scaling', 1, 'decay:app:scaling', 'decay:app:scaling'),
              ('Dimensionless variables', 2, None, '___sec112'),
              ('Dimensionless numbers', 2, None, '___sec113'),
              ('A scaling for vanishing initial condition',
               2,
               None,
               '___sec114'),
              ('Evolution of a population',
               1,
               'decay:app:pop',
               'decay:app:pop'),
              ('Exponential growth',
               2,
               'decay:app:pop:exp',
               'decay:app:pop:exp'),
              ('Logistic growth',
               2,
               'decay:app:pop:log',
               'decay:app:pop:log'),
              ('Compound interest and inflation',
               1,
               'decay:app:interest',
               'decay:app:interest'),
              ("Newton's law of cooling",
               1,
               'decay:app:Newton:cooling',
               'decay:app:Newton:cooling'),
              ('Radioactive decay',
               1,
               'decay:app:nuclear',
               'decay:app:nuclear'),
              ('Deterministic model', 2, None, '___sec121'),
              ('Stochastic model', 2, None, '___sec122'),
              ('Relation between stochastic and deterministic models',
               2,
               None,
               '___sec123'),
              ('Generalization of the radioactive decay modeling',
               2,
               'decay:app:waitingtime',
               'decay:app:waitingtime'),
              ('Chemical kinetics',
               1,
               'decay:app:kinetics',
               'decay:app:kinetics'),
              ('Irreversible reaction of two substances',
               2,
               None,
               '___sec126'),
              ('Reversible reaction of two substances', 2, None, '___sec127'),
              ('Irreversible reaction of two substances into a third',
               2,
               None,
               '___sec128'),
              ('A biochemical reaction', 2, None, '___sec129'),
              ('Spreading of diseases', 1, 'decay:app:SIR', 'decay:app:SIR'),
              ('Predator-prey models in ecology',
               1,
               'decay:app:predprey',
               'decay:app:predprey'),
              ('Decay of atmospheric pressure with altitude',
               1,
               'decay:app:atm',
               'decay:app:atm'),
              ('The general model', 2, None, '___sec133'),
              ('Multiple atmospheric layers', 2, None, '___sec134'),
              ('Simplifications', 2, None, '___sec135'),
              ('Constant layer temperature', 3, None, '___sec136'),
              ('One-layer model', 3, None, '___sec137'),
              ('Compaction of sediments',
               1,
               'decay:app:sediment',
               'decay:app:sediment'),
              ('Vertical motion of a body in a viscous fluid',
               1,
               'decay:app:drag',
               'decay:app:drag'),
              ('Overview of forces', 2, None, '___sec140'),
              ('Equation of motion', 2, None, '___sec141'),
              ('Terminal velocity', 2, None, '___sec142'),
              ('A Crank-Nicolson scheme', 2, None, '___sec143'),
              ('Physical data', 2, None, '___sec144'),
              ('Verification', 2, None, '___sec145'),
              ('Scaling',
               2,
               'decay:app:drag:scaling',
               'decay:app:drag:scaling'),
              ('Viscoelastic materials',
               1,
               'decay:app:viscoelasticity',
               'decay:app:viscoelasticity'),
              ('Decay ODEs from solving a PDE by Fourier expansions',
               1,
               'decay:app:diffusion:Fourier',
               'decay:app:diffusion:Fourier'),
              ('Exercises', 1, None, '___sec149'),
              ('Problem 17: Radioactive decay of Carbon-14',
               2,
               'decay:app:exer:radio:C14',
               'decay:app:exer:radio:C14'),
              ("Exercise 18: Derive schemes for Newton's law of cooling",
               2,
               'decay:app:exer:cooling:schemes',
               'decay:app:exer:cooling:schemes'),
              ("Exercise 19: Implement schemes for Newton's law of cooling",
               2,
               'decay:app:exer:cooling:py',
               'decay:app:exer:cooling:py'),
              ('Bug 1: Wrong time level in the $T_s$ function',
               3,
               None,
               '___sec153'),
              ('Bug 2: Wrong time level in the $T$ function',
               3,
               None,
               '___sec154'),
              ('Bug 3: Missing $\\theta$ in a term', 3, None, '___sec155'),
              ('Bug 4: Missing `k` in the updating formula',
               3,
               None,
               '___sec156'),
              ('Bug 5: Using `1-theta` instead of `theta`',
               3,
               None,
               '___sec157'),
              ('Exercise 20: Find time of murder from body temperature',
               2,
               'decay:app:exer:cooling:murder',
               'decay:app:exer:cooling:murder'),
              ('Exercise 21: Simulate an oscillating cooling process',
               2,
               'decay:app:exer:cooling:osc',
               'decay:app:exer:cooling:osc'),
              ('Exercise 22: Simulate stochastic radioactive decay',
               2,
               'decay:app:exer:stoch:nuclear',
               'decay:app:exer:stoch:nuclear'),
              ('Problem 23: Radioactive decay of two substances',
               2,
               'decay:app:exer:radio:twosubst',
               'decay:app:exer:radio:twosubst'),
              ('Exercise 24: Simulate a simple chemical reaction',
               2,
               'decay:app:exer:kinetics:AB',
               'decay:app:exer:kinetics:AB'),
              ('Exercise 25: Simulate an $n$-th order chemical reaction',
               2,
               'decay:app:exer:kinetics:ABn',
               'decay:app:exer:kinetics:ABn'),
              ('Exercise 26: Simulate a biochemical process',
               2,
               'decay:app:exer:MMK',
               'decay:app:exer:MMK'),
              ('Exercise 27: Simulate spreading of a disease',
               2,
               'decay:app:exer:SIR',
               'decay:app:exer:SIR'),
              ('Exercise 28: Simulate predator-prey interaction',
               2,
               'decay:app:exer:predprey',
               'decay:app:exer:predprey'),
              ('Exercise 29: Simulate the pressure drop in the atmosphere',
               2,
               'decay:app:exer:atm1',
               'decay:app:exer:atm1'),
              ('Exercise 30: Make a program for vertical motion in a fluid',
               2,
               'decay:app:exer:drag:prog',
               'decay:app:exer:drag:prog'),
              ('Project 31: Simulate parachuting',
               2,
               'decay:app:exer:parachute',
               'decay:app:exer:parachute'),
              ('Exercise 32: Formulate vertical motion in the atmosphere',
               2,
               'decay:app:exer:drag:atm1',
               'decay:app:exer:drag:atm1'),
              ('Exercise 33: Simulate vertical motion in the atmosphere',
               2,
               'decay:app:exer:drag:atm2',
               'decay:app:exer:drag:atm2'),
              ('Problem 34: Compute $y=|x|$ by solving an ODE',
               2,
               'decay:app:exer:signum',
               'decay:app:exer:signum'),
              ('Problem 35: Simulate fortune growth with random interest rate',
               2,
               'decay:app:exer:interest',
               'decay:app:exer:interest'),
              ('Exercise 36: Simulate a population in a changing environment',
               2,
               'decay:app:exer:pop:at',
               'decay:app:exer:pop:at'),
              ('Exercise 37: Simulate logistic growth',
               2,
               'decay:app:exer:pop:logistic1',
               'decay:app:exer:pop:logistic1'),
              ('Exercise 38: Rederive the equation for continuous compound interest',
               2,
               'decay:app:exer:interest:derive',
               'decay:app:exer:interest:derive'),
              ('Exercise 39: Simulate the deformation of a viscoelastic material',
               2,
               'decay:app:exer:viscoelasticity1',
               'decay:app:exer:viscoelasticity1'),
              ('Scientific software engineering', 0, 'decay:se', 'decay:se'),
              ('Implementations with functions and modules',
               1,
               'softeng1:basic',
               'softeng1:basic'),
              ('Mathematical problem and solution technique',
               2,
               'softeng1:basic:math',
               'softeng1:basic:math'),
              ('A first, quick implementation',
               2,
               'softeng1:basic:impl1',
               'softeng1:basic:impl1'),
              ('A more decent program',
               2,
               'softeng1:basic:impl2',
               'softeng1:basic:impl2'),
              ('Comments in a program', 3, None, '___sec183'),
              ('Refactoring into functions', 3, None, '___sec184'),
              ('Program file vs IDE vs notebook', 3, None, '___sec185'),
              ('Prefixing imported functions by the module name',
               2,
               'softeng1:basic:modprefix',
               'softeng1:basic:modprefix'),
              ('Implementing the numerical algorithm in a function',
               2,
               'softeng1:basic:func',
               'softeng1:basic:func'),
              ('Do not have several versions of a code',
               2,
               None,
               '___sec188'),
              ('Making a module',
               2,
               'softeng1:basic:module',
               'softeng1:basic:module'),
              ('Example on extending the module code',
               2,
               'softeng1:basic:experiment2',
               'softeng1:basic:experiment2'),
              ('Documenting functions and modules',
               2,
               'softeng1:basic:docstring',
               'softeng1:basic:docstring'),
              ('Logging intermediate results',
               2,
               'softeng1:basic:logging',
               'softeng1:basic:logging'),
              ('Introductory example', 3, None, '___sec193'),
              ('Using a logger in our solver function', 3, None, '___sec194'),
              ('User interfaces',
               1,
               'softeng1:basic:UI',
               'softeng1:basic:UI'),
              ('Command-line arguments', 2, None, '___sec196'),
              ('Positional command-line arguments', 2, None, '___sec197'),
              ('Option-value pairs on the command line',
               2,
               None,
               '___sec198'),
              ('Creating a graphical web user interface',
               2,
               None,
               '___sec199'),
              ('Making a compute function', 3, None, '___sec200'),
              ('Generating the user interface', 3, None, '___sec201'),
              ('Running the web application', 3, None, '___sec202'),
              ('Tests for verifying implementations', 1, None, '___sec203'),
              ('Doctests', 2, None, '___sec204'),
              ('Unit tests and test functions', 2, None, '___sec205'),
              ('Two Python test frameworks: nose and pytest',
               3,
               None,
               '___sec206'),
              ('Test function requirements', 3, None, '___sec207'),
              ('Comparison of real numbers', 3, None, '___sec208'),
              ('Special assert functions from nose', 3, None, '___sec209'),
              ('Locating test functions', 3, None, '___sec210'),
              ('Running tests', 3, None, '___sec211'),
              ('Embedding doctests in a test function', 3, None, '___sec212'),
              ('Installing nose and pytest', 3, None, '___sec213'),
              ('Test function for the solver', 2, None, '___sec214'),
              ('Test function for reading positional command-line arguments',
               2,
               None,
               '___sec215'),
              ('Test function for reading option-value pairs',
               2,
               None,
               '___sec216'),
              ('Classical class-based unit testing',
               2,
               'softeng1:basic:unittest',
               'softeng1:basic:unittest'),
              ('Sharing the software with other users',
               1,
               'softeng1:prog:se:git',
               'softeng1:prog:se:git'),
              ('Organizing the software directory tree',
               2,
               None,
               '___sec219'),
              ('Distributing just a module file', 3, None, '___sec220'),
              ('Distributing a package', 3, None, '___sec221'),
              ('Publishing the software at GitHub', 2, None, '___sec222'),
              ('Downloading and installing the software',
               2,
               None,
               '___sec223'),
              ('Installing just a module file', 3, None, '___sec224'),
              ('Installing a package', 3, None, '___sec225'),
              ('Classes for problem and solution method',
               1,
               'softeng1:prog:se:class',
               'softeng1:prog:se:class'),
              ('The problem class', 2, None, '___sec227'),
              ('The solver class', 2, None, '___sec228'),
              ('Combining the objects', 3, None, '___sec229'),
              ('Improving the problem and solver classes',
               2,
               'softeng1:prog:se:class2',
               'softeng1:prog:se:class2'),
              ('A generic class for parameters', 3, None, '___sec231'),
              ('Automating scientific experiments',
               1,
               'softeng1:experiments',
               'softeng1:experiments'),
              ('Available software', 2, None, '___sec233'),
              ('The results we want to produce', 2, None, '___sec234'),
              ('Combining plot files', 2, None, '___sec235'),
              ('Running a program from Python', 2, None, '___sec236'),
              ('The automating script', 2, None, '___sec237'),
              ('Making a report',
               2,
               'softeng1:exper:report',
               'softeng1:exper:report'),
              ('Word, OpenOffice, GoogleDocs', 3, None, '___sec239'),
              ('HTML with MathJax', 3, None, '___sec240'),
              ('LaTeX', 3, None, '___sec241'),
              ('Sphinx', 3, None, '___sec242'),
              ('Markdown', 3, None, '___sec243'),
              ('IPython/Jupyter notebooks', 3, None, '___sec244'),
              ('Wiki formats', 3, None, '___sec245'),
              ('DocOnce', 3, None, '___sec246'),
              ('Publishing a complete project',
               2,
               'softeng1:exper:github',
               'softeng1:exper:github'),
              ('Exercises', 1, None, '___sec248'),
              ('Problem 40: Make a tool for differentiating curves',
               2,
               'softeng1:exer:derivative',
               'softeng1:exer:derivative'),
              ('Problem 41: Make solid software for the Trapezoidal rule',
               2,
               'softeng1:exer:integral:flat',
               'softeng1:exer:integral:flat'),
              ('Problem 42: Implement classes for the Trapezoidal rule',
               2,
               'softeng1:exer:integral:flat2',
               'softeng1:exer:integral:flat2'),
              ('Problem 43: Write a doctest and a test function',
               2,
               'softeng1:exer:doctest1',
               'softeng1:exer:doctest1'),
              ('Problem 44: Experiment with tolerances in comparisons',
               2,
               'softeng1:exer:tol',
               'softeng1:exer:tol'),
              ('Remarks', 3, None, '___sec254'),
              ('Exercise 45: Make use of a class implementation',
               2,
               'softeng1:exer:class:dts',
               'softeng1:exer:class:dts'),
              ('Problem 46: Make solid software for a difference equation',
               2,
               'softeng1:exer:logistic',
               'softeng1:exer:logistic'),
              ('Summarizing multiple-choice questions', 0, None, '___sec257'),
              ('Quiz', 1, None, '___sec258'),
              ('Exercise 47: Characterize a finite difference',
               2,
               'decay:quiz:fd:FE',
               'decay:quiz:fd:FE'),
              ('Exercise 48: Characterize a finite difference',
               2,
               'decay:quiz:fd:CN',
               'decay:quiz:fd:CN'),
              ('Exercise 49: What is the problem with this program?',
               2,
               'decay:quiz:program',
               'decay:quiz:program'),
              ('Exercise 50: Is the solution correct?',
               2,
               'decay:quiz:stability',
               'decay:quiz:stability'),
              ('Exercise 51: Is this a proper test function?',
               2,
               'decay:quiz:testfunc',
               'decay:quiz:testfunc'),
              ('Exercise 52: Rewrite an expression with array arithmetics',
               2,
               'decay:quiz:arrayarithm',
               'decay:quiz:arrayarithm'),
              ('Exercise 53: What is the truncation error?',
               2,
               'decay:quiz:trunc',
               'decay:quiz:trunc'),
              ('Exercise 54: Recognize a programming language',
               2,
               'decay:quiz:prog:m',
               'decay:quiz:prog:m'),
              ('Exercise 55: Recognize a programming language',
               2,
               'decay:quiz:prog:py',
               'decay:quiz:prog:py'),
              ('Exercise 56: Recognize a programming language',
               2,
               'decay:quiz:prog:f77',
               'decay:quiz:prog:f77'),
              ('Exercise 57: Recognize a programming language',
               2,
               'decay:quiz:prog:c',
               'decay:quiz:prog:c'),
              ('Exercise 58: What is SymPy?',
               2,
               'decay:quiz:sympy1',
               'decay:quiz:sympy1'),
              ('Exercise 59: Testing of code',
               2,
               'decay:quiz:testing1',
               'decay:quiz:testing1'),
              ('Exercise 60: What kind of scheme is this?',
               2,
               'decay:quiz:scheme:CN_error',
               'decay:quiz:scheme:CN_error'),
              ('Exercise 61: What kind of scheme is this?',
               2,
               'decay:quiz:scheme:BE',
               'decay:quiz:scheme:BE'),
              ('Exercise 62: What kind of scheme is this?',
               2,
               'decay:quiz:scheme:leapfrog',
               'decay:quiz:scheme:leapfrog'),
              ('References', 1, None, '___sec275')]}
end of tocinfo -->

<body>



<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: {
     equationNumbers: {  autoNumber: "none"  },
     extensions: ["AMSmath.js", "AMSsymbols.js", "autobold.js", "color.js"]
  }
});
</script>
<script type="text/javascript"
 src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>

<!-- newcommands_keep.tex -->
$$
\newcommand{\half}{\frac{1}{2}}
\newcommand{\tp}{\thinspace .}
\newcommand{\uex}{{u_{\small\mbox{e}}}}
\newcommand{\Aex}{{A_{\small\mbox{e}}}}
\newcommand{\E}[1]{\hbox{E}\lbrack #1 \rbrack}
\newcommand{\Var}[1]{\hbox{Var}\lbrack #1 \rbrack}
\newcommand{\Std}[1]{\hbox{Std}\lbrack #1 \rbrack}
\newcommand{\Oof}[1]{\mathcal{O}(#1)}
\newcommand{\stress}{\boldsymbol{\sigma}}
$$




    
<!-- Bootstrap navigation bar -->
<div class="navbar navbar-default navbar-fixed-top">
  <div class="navbar-header">
    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-responsive-collapse">
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href=".trash82dee82e1274a586571086dca04d00308d3a0d86.html">Finite Difference Computing with Exponential Decay Models</a>
  </div>
  <div class="navbar-collapse collapse navbar-responsive-collapse">
    <ul class="nav navbar-nav navbar-right">
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Contents <b class="caret"></b></a>
        <ul class="dropdown-menu">
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86001.html#ch:preface" style="font-size: 80%;">Preface</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86003.html#___sec2" style="font-size: 80%;">Algorithms and implementations</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86006.html#decay:analysis" style="font-size: 80%;">Analysis</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86007.html#___sec73" style="font-size: 80%;">Generalizations</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86008.html#decay:app" style="font-size: 80%;">Models</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86009.html#decay:se" style="font-size: 80%;">Scientific software engineering</a></li>
     <!-- navigation toc: --> <li><a href="#___sec257" style="font-size: 80%;">Summarizing multiple-choice questions</a></li>

        </ul>
      </li>
    </ul>
  </div>
</div>
</div> <!-- end of navigation bar -->

<div class="container">

<p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p> <!-- add vertical space -->

<a name="part0010"></a>
<!-- !split -->

<center><h1 id="___sec257">Summarizing multiple-choice questions </h1></center> <!-- chapter heading -->

<h1 id="___sec258">Quiz </h1>

<p>
<!-- --- begin exercise --- -->

<h2 id="decay:quiz:fd:FE">Exercise 47: Characterize a finite difference</h2>

<p>
<!-- --- previous heading type: exercise -->
<!-- begin quiz -->
<hr>
<p>
<b>Question:</b> We can approximate the derivative at a point using two function values:

<p>
<center><p><img src="fig-quiz/fd_forward2.png" align="bottom" width=400></p></center>

<p>
What is this type of difference called and how large is the error?</p>

<p>
<a class="glyphicon glyphicon-pencil showdetails" data-toggle="collapse"
 data-target="#quiz_id_1_A" style="font-size: 80%;"></a>
&nbsp;<b>Choice A:</b>
This is a centered difference with error proportional to \( \Delta t^2 \).
<div class="collapse-group">
<p><div class="collapse" id="quiz_id_1_A">
<img src="https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/incorrect.gif">
No, a centered difference would have the two function values equally displaced to either side of the target point \( t_n \).
</div></p>
</div>
</p>

<p>
<a class="glyphicon glyphicon-pencil showdetails" data-toggle="collapse"
 data-target="#quiz_id_1_B" style="font-size: 80%;"></a>
&nbsp;<b>Choice B:</b>
This is a forward difference with error proportional to \( \Delta t \).
<div class="collapse-group">
<p><div class="collapse" id="quiz_id_1_B">
<img src="https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/correct.gif">
The name is forward difference, or Forward Euler difference in the context of differential equations. In such contexts the formula is also known as Euler's method or formula.
</div></p>
</div>
</p>

<p>
<a class="glyphicon glyphicon-pencil showdetails" data-toggle="collapse"
 data-target="#quiz_id_1_C" style="font-size: 80%;"></a>
&nbsp;<b>Choice C:</b>
This is a Forward Euler difference with error proportional to \( \Delta t^3 \).
<div class="collapse-group">
<p><div class="collapse" id="quiz_id_1_C">
<img src="https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/incorrect.gif">
One may well call this a Forward Euler difference, but the error is not as &quot;good&quot; as \( \Delta t^3 \).
</div></p>
</div>
</p>

<p>
<a class="glyphicon glyphicon-pencil showdetails" data-toggle="collapse"
 data-target="#quiz_id_1_D" style="font-size: 80%;"></a>
&nbsp;<b>Choice D:</b>
This is a Backward Euler finite difference with error proportional to \( \Delta t \).
<div class="collapse-group">
<p><div class="collapse" id="quiz_id_1_D">
<img src="https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/incorrect.gif">
Since we use the points \( t_{n+1} \) and \( t_n \) when constructing the difference, we go <em>forward</em> in time, not backward. Therefore, this is a forward difference.
</div></p>
</div>
</p>
<!-- end quiz -->


<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="decay:quiz:fd:CN">Exercise 48: Characterize a finite difference</h2>

<p>
<!-- --- previous heading type: exercise -->
<!-- begin quiz -->
<hr>
<p>
<b>Question:</b> We can approximate the derivative at a point using two function values:

<p>
<center><p><img src="fig-quiz/fd_centered2.png" align="bottom" width=400></p></center>

<p>
What is this type of difference called and how large is the error?</p>

<p>
<a class="glyphicon glyphicon-pencil showdetails" data-toggle="collapse"
 data-target="#quiz_id_2_A" style="font-size: 80%;"></a>
&nbsp;<b>Choice A:</b>
This is a centered difference with error proportional to \( \Delta t^2 \).
<div class="collapse-group">
<p><div class="collapse" id="quiz_id_2_A">
<img src="https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/correct.gif">
Correct!
</div></p>
</div>
</p>

<p>
<a class="glyphicon glyphicon-pencil showdetails" data-toggle="collapse"
 data-target="#quiz_id_2_B" style="font-size: 80%;"></a>
&nbsp;<b>Choice B:</b>
This is a forward difference with error proportional to \( \Delta t^2 \).
<div class="collapse-group">
<p><div class="collapse" id="quiz_id_2_B">
<img src="https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/incorrect.gif">
A forward difference makes use of the point itself, \( t_n \), and a point <em>forward</em> in time, \( t_{n+1} \). This is not the case here: we use points to the left and right, and the derivative is approximated in the center point. Also, a forward difference would not have an error \( \mathcal{O}(\Delta t^2) \).
</div></p>
</div>
</p>

<p>
<a class="glyphicon glyphicon-pencil showdetails" data-toggle="collapse"
 data-target="#quiz_id_2_C" style="font-size: 80%;"></a>
&nbsp;<b>Choice C:</b>
This is a centered difference with error proportional to \( \Delta t^4 \).
<div class="collapse-group">
<p><div class="collapse" id="quiz_id_2_C">
<img src="https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/incorrect.gif">
It is centered, but the error is only \( \mathcal{O}(\Delta t^2) \).
</div></p>
</div>
</p>

<p>
<a class="glyphicon glyphicon-pencil showdetails" data-toggle="collapse"
 data-target="#quiz_id_2_D" style="font-size: 80%;"></a>
&nbsp;<b>Choice D:</b>
This is a Backward Euler finite difference with error proportional to \( \Delta t \).
<div class="collapse-group">
<p><div class="collapse" id="quiz_id_2_D">
<img src="https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/incorrect.gif">
Since we use the points \( t_{n+1} \) and \( t_n \) when constructing the difference at \( t_{n+1/2} \), the derivative is in the <em>center</em> of the two points, and the difference is therefore a <em>centered</em> difference. A backward difference, or Backward Euler difference, would use \( t_{n+1/2} \) in this case and some point \( t_{n-1/2} \) <em>backward</em> in time.
</div></p>
</div>
</p>
<!-- end quiz -->


<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="decay:quiz:program">Exercise 49: What is the problem with this program?</h2>

<p>
<!-- --- previous heading type: exercise -->
<!-- begin quiz -->
<hr>
<p>
<b>Question:</b> We want to solve

$$ u ' = -au, \quad u(0)=1, $$

by a Forward Euler scheme,

$$ u^{n+1} = u^n - a\Delta t\, u^n,$$

and the following program

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">numpy</span> <span style="color: #008000; font-weight: bold">import</span> <span style="color: #666666">*</span>
u <span style="color: #666666">=</span> zeros(<span style="color: #666666">10</span>)
u[<span style="color: #666666">0</span>] <span style="color: #666666">=</span> <span style="color: #666666">1</span>
dt <span style="color: #666666">=</span> <span style="color: #666666">0.1</span>
<span style="color: #008000; font-weight: bold">for</span> i <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(<span style="color: #666666">10</span>):
    u[i<span style="color: #666666">+1</span>] <span style="color: #666666">=</span> u[i] <span style="color: #666666">-</span> dt<span style="color: #666666">*</span>a<span style="color: #666666">*</span>u[n]
</pre></div>
<p>
What is the major problem with this program?</p>

<p>
<a class="glyphicon glyphicon-pencil showdetails" data-toggle="collapse"
 data-target="#quiz_id_3_A" style="font-size: 80%;"></a>
&nbsp;<b>Choice A:</b>
<code>from numpy import *</code> is not recommended; one should import explicitly the functions needed or do <code>import numpy as np</code>.
<div class="collapse-group">
<p><div class="collapse" id="quiz_id_3_A">
<img src="https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/incorrect.gif">
True, these are recommended rules, but it is not a problem to do the &quot;star import&quot;: it is legal and convenient.
</div></p>
</div>
</p>

<p>
<a class="glyphicon glyphicon-pencil showdetails" data-toggle="collapse"
 data-target="#quiz_id_3_B" style="font-size: 80%;"></a>
&nbsp;<b>Choice B:</b>
The program aborts with a <code>NameError</code>.
<div class="collapse-group">
<p><div class="collapse" id="quiz_id_3_B">
<img src="https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/correct.gif">
True, <code>a</code> is not defined. This is the only reason why one cannot execute the program.
</div></p>
</div>
</p>

<p>
<a class="glyphicon glyphicon-pencil showdetails" data-toggle="collapse"
 data-target="#quiz_id_3_C" style="font-size: 80%;"></a>
&nbsp;<b>Choice C:</b>
The program is &quot;flat&quot;. It should be wrapped in a function <code>solver(U0, dt, N, a)</code>.
<div class="collapse-group">
<p><div class="collapse" id="quiz_id_3_C">
<img src="https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/incorrect.gif">
That is definitely a good idea, but it is not a major problem for computing the solution of the differential equation.
</div></p>
</div>
</p>

<p>
<a class="glyphicon glyphicon-pencil showdetails" data-toggle="collapse"
 data-target="#quiz_id_3_D" style="font-size: 80%;"></a>
&nbsp;<b>Choice D:</b>
The scheme is unstable!
<div class="collapse-group">
<p><div class="collapse" id="quiz_id_3_D">
<img src="https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/incorrect.gif">
Actually, this can be true. Since <code>a</code> is not defined, it may happen that <code>dt=0.1</code> is a too long time step for the stability restrictions of the Forward Euler method for this differential equation. We need \( \Delta t\leq 1/a \). However, the answer is wrong in the sense that this <em>potential</em> instability is not the major problem with the program - it is a bigger problem that <code>a</code> is not defined.
</div></p>
</div>
</p>
<!-- end quiz -->


<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="decay:quiz:stability">Exercise 50: Is the solution correct?</h2>

<p>
<!-- --- previous heading type: exercise -->
<!-- begin quiz -->
<hr>
<p>
<b>Question:</b> You have solved \( u'=-au \) by the Crank-Nicolson scheme and tested
your program thoroughly. Suddenly you run the program with \( I=1 \), \( a=10 \), \( T=1 \), and \( \Delta t=0.225 \). You get somewhat unexpected results:

<p>
<center><p><img src="fig-quiz/CN_osc.png" align="bottom" width=500></p></center>

<p>
The results are unexpected because we know the exact solution should be
monotone and decreasing, while this numerical solution also shows an
increasing stage. What is the problem?</p>

<p>
<a class="glyphicon glyphicon-pencil showdetails" data-toggle="collapse"
 data-target="#quiz_id_4_A" style="font-size: 80%;"></a>
&nbsp;<b>Choice A:</b>
The program is not tested well enough - yet another bug is there.
<div class="collapse-group">
<p><div class="collapse" id="quiz_id_4_A">
<img src="https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/incorrect.gif">
No, this computation is in fact correct - numerically.
</div></p>
</div>
</p>

<p>
<a class="glyphicon glyphicon-pencil showdetails" data-toggle="collapse"
 data-target="#quiz_id_4_B" style="font-size: 80%;"></a>
&nbsp;<b>Choice B:</b>
The numerical solution method is more general than the analytical one,
and this is an example where the solution can increase, but the analytical
solution technique is not capable of dealing with this situation.
<div class="collapse-group">
<p><div class="collapse" id="quiz_id_4_B">
<img src="https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/incorrect.gif">
The analytical solution \( u(t)=Ie^{-at} \) covers all possible cases.
</div></p>
</div>
</p>

<p>
<a class="glyphicon glyphicon-pencil showdetails" data-toggle="collapse"
 data-target="#quiz_id_4_C" style="font-size: 80%;"></a>
&nbsp;<b>Choice C:</b>
The time step is too large and cause an instability in the form of non-physical oscillations.
<div class="collapse-group">
<p><div class="collapse" id="quiz_id_4_C">
<img src="https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/correct.gif">
True. One needs \( \Delta t \leq 2/a = 0.2 \) in this case to avoid oscillations.
</div></p>
</div>
</p>

<p>
<a class="glyphicon glyphicon-pencil showdetails" data-toggle="collapse"
 data-target="#quiz_id_4_D" style="font-size: 80%;"></a>
&nbsp;<b>Choice D:</b>
The Crank-Nicolson scheme is unconditionally stable and can be used with all time-step sizes, but the problem here is that round-off errors due to a &quot;too large&quot; \( a \) (10, not around 1) accumulate to the effect seen in the plot.
<div class="collapse-group">
<p><div class="collapse" id="quiz_id_4_D">
<img src="https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/incorrect.gif">
1: The first part is true if unconditionally stable means that the solution is bounded and decays with time, but one may also argue that oscillations, which are non-physical, are a kind of instability, and these occur if \( \Delta t >2/a \).
2: Round-off errors are <em>very</em> small in this problem, compared to the discretization errors, and cannot cause an oscillating solution.
</div></p>
</div>
</p>
<!-- end quiz -->


<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="decay:quiz:testfunc">Exercise 51: Is this a proper test function?</h2>

<p>
<!-- --- previous heading type: exercise -->
<!-- begin quiz -->
<hr>
<p>
<b>Question:</b> Suppose we have some function <code>compute</code> that we want to test. We construct
a unit test and implement an associated test function (according to the
rules for test functions in the nose or pytest test frameworks):

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">test_compute</span>(n):
    expected <span style="color: #666666">=</span> (n<span style="color: #666666">**2</span>)<span style="color: #666666">/4.5</span> <span style="color: #666666">-</span> <span style="color: #666666">1</span>
    computed <span style="color: #666666">=</span> compute(n)
    <span style="color: #008000; font-weight: bold">assert</span> expected <span style="color: #666666">!=</span> computed
</pre></div>
<p>
The question is if this test function can be used as is or if improvements
must be implemented.</p>

<p>
<a class="glyphicon glyphicon-pencil showdetails" data-toggle="collapse"
 data-target="#quiz_id_5_A" style="font-size: 80%;"></a>
&nbsp;<b>Choice A:</b>
One should use special assert functions from <code>nose.tools</code>, here the choice is <code>nose.tools.assert_almost_equal</code>.
<div class="collapse-group">
<p><div class="collapse" id="quiz_id_5_A">
<img src="https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/incorrect.gif">
It is true that an &quot;almost equal&quot; type of assert function is appropriate, but there is nothing in the rules that requires use of special assert functions. The requirement is that an <code>AssertionError</code> is raised if the test fails. That is done by a plain <code>assert</code> as used here.
</div></p>
</div>
</p>

<p>
<a class="glyphicon glyphicon-pencil showdetails" data-toggle="collapse"
 data-target="#quiz_id_5_B" style="font-size: 80%;"></a>
&nbsp;<b>Choice B:</b>
One cannot test <code>compute(n)</code> for only one <code>n</code> value. Many are required for good evidence that the function works.
<div class="collapse-group">
<p><div class="collapse" id="quiz_id_5_B">
<img src="https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/incorrect.gif">
This depends on what is inside <code>compute</code>. If it has several branches depending on the value of <code>n</code>, one must test for a visit to each branch, which requires multiple <code>n</code> values, but if it is a formula (the test might indicate so), one value can be sufficient.
</div></p>
</div>
</p>

<p>
<a class="glyphicon glyphicon-pencil showdetails" data-toggle="collapse"
 data-target="#quiz_id_5_C" style="font-size: 80%;"></a>
&nbsp;<b>Choice C:</b>
The test function does not test <code>expected != computed</code> with a tolerance
and the <code>n</code> parameter cannot be an argument.
<div class="collapse-group">
<p><div class="collapse" id="quiz_id_5_C">
<img src="https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/correct.gif">
The formula for <code>expected</code> indicates that this is a real number that is subject to potential round-off errors, so one should use a tolerance: <code>abs(expected - computed) &lt; 1E-14</code>. Also, test functions should never take arguments.
</div></p>
</div>
</p>

<p>
<a class="glyphicon glyphicon-pencil showdetails" data-toggle="collapse"
 data-target="#quiz_id_5_D" style="font-size: 80%;"></a>
&nbsp;<b>Choice D:</b>
The <code>assert</code> statement also needs a message explaining what is wrong when the test fails.
<div class="collapse-group">
<p><div class="collapse" id="quiz_id_5_D">
<img src="https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/incorrect.gif">
This is always a good idea, but not a requirement.
</div></p>
</div>
</p>
<!-- end quiz -->


<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="decay:quiz:arrayarithm">Exercise 52: Rewrite an expression with array arithmetics</h2>

<p>
<!-- --- previous heading type: exercise -->
<!-- begin quiz -->
<hr>
<p>
<b>Question:</b> A mesh function is initialized with the code segment

<p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">math</span> <span style="color: #008000; font-weight: bold">import</span> exp
N_t <span style="color: #666666">=</span> <span style="color: #666666">100</span>
T <span style="color: #666666">=</span> <span style="color: #666666">3.0</span>
dt <span style="color: #666666">=</span> T<span style="color: #666666">/</span>N_t
t <span style="color: #666666">=</span> []
u <span style="color: #666666">=</span> []
<span style="color: #008000; font-weight: bold">for</span> i <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(<span style="color: #008000">len</span>(t)):
    t<span style="color: #666666">.</span>append(i<span style="color: #666666">*</span>dt)
    u<span style="color: #666666">.</span>append(<span style="color: #666666">1</span> <span style="color: #666666">-</span> exp(<span style="color: #666666">-</span>t[<span style="color: #666666">-1</span>]))
</pre></div>
<p>
Rewrite this code such that there is no loop and <code>u</code> is computed by
array arithmetics.</p>

<p>
<a class="glyphicon glyphicon-pencil showdetails" data-toggle="collapse"
 data-target="#quiz_id_6_A" style="font-size: 80%;"></a>
&nbsp;<b>Choice A:</b>
<p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">numpy</span> <span style="color: #008000; font-weight: bold">import</span> <span style="color: #666666">*</span>
<span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">math</span> <span style="color: #008000; font-weight: bold">import</span> exp
N_t <span style="color: #666666">=</span> <span style="color: #666666">100</span>
t <span style="color: #666666">=</span> np<span style="color: #666666">.</span>linspace(<span style="color: #666666">0</span>, <span style="color: #666666">3</span>, N_t<span style="color: #666666">+1</span>)
u <span style="color: #666666">=</span> <span style="color: #666666">1</span> <span style="color: #666666">-</span> exp(<span style="color: #666666">-</span>t)
</pre></div>
<p>
<div class="collapse-group">
<p><div class="collapse" id="quiz_id_6_A">
<img src="https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/incorrect.gif">
The <code>exp</code> function is imported from <code>math</code> (since <code>from math import exp</code>
reimports the <code>exp</code> name that was imported by <code>from numpy import *</code>)
and cannot be used with array argument <code>t</code>.
</div></p>
</div>
</p>

<p>
<a class="glyphicon glyphicon-pencil showdetails" data-toggle="collapse"
 data-target="#quiz_id_6_B" style="font-size: 80%;"></a>
&nbsp;<b>Choice B:</b>
<p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">numpy</span> <span style="color: #008000; font-weight: bold">as</span> <span style="color: #0000FF; font-weight: bold">np</span>
N_t <span style="color: #666666">=</span> <span style="color: #666666">100</span>
t <span style="color: #666666">=</span> np<span style="color: #666666">.</span>linspace(<span style="color: #666666">0</span>, <span style="color: #666666">3</span>, N_t<span style="color: #666666">+1</span>)
u <span style="color: #666666">=</span> <span style="color: #666666">1</span> <span style="color: #666666">-</span> np<span style="color: #666666">.</span>exp(<span style="color: #666666">-</span>t)
</pre></div>
<p>
<div class="collapse-group">
<p><div class="collapse" id="quiz_id_6_B">
<img src="https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/correct.gif">
Correct!
</div></p>
</div>
</p>

<p>
<a class="glyphicon glyphicon-pencil showdetails" data-toggle="collapse"
 data-target="#quiz_id_6_C" style="font-size: 80%;"></a>
&nbsp;<b>Choice C:</b>
<p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">N_t <span style="color: #666666">=</span> <span style="color: #666666">100</span>
dt <span style="color: #666666">=</span> <span style="color: #666666">3.0/</span>N_t
t <span style="color: #666666">=</span> [i<span style="color: #666666">*</span>dt <span style="color: #008000; font-weight: bold">for</span> i <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(N_t<span style="color: #666666">+1</span>)]
<span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">numpy</span> <span style="color: #008000; font-weight: bold">import</span> exp
u <span style="color: #666666">=</span> <span style="color: #666666">1</span> <span style="color: #666666">-</span> exp(<span style="color: #666666">-</span>t)
</pre></div>
<p>
<div class="collapse-group">
<p><div class="collapse" id="quiz_id_6_C">
<img src="https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/incorrect.gif">
The computation of <code>u</code> applies array arithmetics, but the list
comprehension for <code>t</code> involves a standard (slow) Python loop.
</div></p>
</div>
</p>

<p>
<a class="glyphicon glyphicon-pencil showdetails" data-toggle="collapse"
 data-target="#quiz_id_6_D" style="font-size: 80%;"></a>
&nbsp;<b>Choice D:</b>
<p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">numpy</span>
t <span style="color: #666666">=</span> numpy<span style="color: #666666">.</span>mesh([<span style="color: #666666">0</span>, <span style="color: #666666">3</span>], <span style="color: #666666">100</span>)
u <span style="color: #666666">=</span> numpy<span style="color: #666666">.</span>func(numpy<span style="color: #666666">.</span>exp, t)
</pre></div>
<p>
<div class="collapse-group">
<p><div class="collapse" id="quiz_id_6_D">
<img src="https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/incorrect.gif">
There are no functions <code>numpy.mesh</code> and <code>numpy.func</code>.
</div></p>
</div>
</p>
<!-- end quiz -->


<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="decay:quiz:trunc">Exercise 53: What is the truncation error?</h2>

<p>
<!-- --- previous heading type: exercise -->
<!-- begin quiz -->
<hr>
<p>
<b>Question:</b> What is the truncation error?</p>

<p>
<a class="glyphicon glyphicon-pencil showdetails" data-toggle="collapse"
 data-target="#quiz_id_7_A" style="font-size: 80%;"></a>
&nbsp;<b>Choice A:</b>
The difference between the exact solution and the numerical solution
at a mesh point.
<div class="collapse-group">
<p><div class="collapse" id="quiz_id_7_A">
<img src="https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/incorrect.gif">
This is the global error.
</div></p>
</div>
</p>

<p>
<a class="glyphicon glyphicon-pencil showdetails" data-toggle="collapse"
 data-target="#quiz_id_7_B" style="font-size: 80%;"></a>
&nbsp;<b>Choice B:</b>
The error in the factor that takes <code>u[i]</code> to <code>u[i+1]</code>.
<div class="collapse-group">
<p><div class="collapse" id="quiz_id_7_B">
<img src="https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/incorrect.gif">
This is the amplification factor error or the local error.
</div></p>
</div>
</p>

<p>
<a class="glyphicon glyphicon-pencil showdetails" data-toggle="collapse"
 data-target="#quiz_id_7_C" style="font-size: 80%;"></a>
&nbsp;<b>Choice C:</b>
The difference between the exact solution and the numerical
solution truncated to one decimal.
<div class="collapse-group">
<p><div class="collapse" id="quiz_id_7_C">
<img src="https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/incorrect.gif">
Nobody applies this error measure.
</div></p>
</div>
</p>

<p>
<a class="glyphicon glyphicon-pencil showdetails" data-toggle="collapse"
 data-target="#quiz_id_7_D" style="font-size: 80%;"></a>
&nbsp;<b>Choice D:</b>
The error in the scheme when the exact solution is inserted in the
scheme's difference equation.
<div class="collapse-group">
<p><div class="collapse" id="quiz_id_7_D">
<img src="https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/correct.gif">
Correct!
</div></p>
</div>
</p>
<!-- end quiz -->


<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="decay:quiz:prog:m">Exercise 54: Recognize a programming language</h2>

<p>
<!-- --- previous heading type: exercise -->
<!-- begin quiz -->
<hr>
<p>
<b>Question:</b> What kind of programming language is this?

<p>

<!-- code=matlab (!bc mcod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #008000; font-weight: bold">function</span><span style="color: #bbbbbb"> </span>integral =<span style="color: #bbbbbb"> </span><span style="color: #0000FF">trapezoidal</span>(f, a, b, n)<span style="color: #bbbbbb"></span>
<span style="color: #bbbbbb">    </span><span style="color: #408080; font-style: italic">%% Integrate f from a to b with n intervals</span>
    h = (b<span style="color: #666666">-</span>a)<span style="color: #666666">/</span>n;
    result = <span style="color: #666666">0.5*</span>f(a) <span style="color: #666666">+</span> <span style="color: #666666">0.5*</span>f(b);
    <span style="color: #008000; font-weight: bold">for</span> <span style="color: #008000">i</span> = <span style="color: #666666">1</span>:(n<span style="color: #666666">-1</span>)
        result = result <span style="color: #666666">+</span> f(a <span style="color: #666666">+</span> <span style="color: #008000">i</span><span style="color: #666666">*</span>h);
    <span style="color: #008000; font-weight: bold">end</span>
    integral = h<span style="color: #666666">*</span>result;
<span style="color: #008000; font-weight: bold">end</span>
</pre></div>
<p></p>

<p>
<a class="glyphicon glyphicon-pencil showdetails" data-toggle="collapse"
 data-target="#quiz_id_8_A" style="font-size: 80%;"></a>
&nbsp;<b>Choice A:</b>
Python
<div class="collapse-group">
<p><div class="collapse" id="quiz_id_8_A">
<img src="https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/incorrect.gif">
Wrong!
</div></p>
</div>
</p>

<p>
<a class="glyphicon glyphicon-pencil showdetails" data-toggle="collapse"
 data-target="#quiz_id_8_B" style="font-size: 80%;"></a>
&nbsp;<b>Choice B:</b>
MATLAB or Octave
<div class="collapse-group">
<p><div class="collapse" id="quiz_id_8_B">
<img src="https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/correct.gif">
Correct!
</div></p>
</div>
</p>

<p>
<a class="glyphicon glyphicon-pencil showdetails" data-toggle="collapse"
 data-target="#quiz_id_8_C" style="font-size: 80%;"></a>
&nbsp;<b>Choice C:</b>
Cython
<div class="collapse-group">
<p><div class="collapse" id="quiz_id_8_C">
<img src="https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/incorrect.gif">
Wrong!
</div></p>
</div>
</p>

<p>
<a class="glyphicon glyphicon-pencil showdetails" data-toggle="collapse"
 data-target="#quiz_id_8_D" style="font-size: 80%;"></a>
&nbsp;<b>Choice D:</b>
FORTRAN 77
<div class="collapse-group">
<p><div class="collapse" id="quiz_id_8_D">
<img src="https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/incorrect.gif">
Wrong!
</div></p>
</div>
</p>
<!-- end quiz -->


<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="decay:quiz:prog:py">Exercise 55: Recognize a programming language</h2>

<p>
<!-- --- previous heading type: exercise -->
<!-- begin quiz -->
<hr>
<p>
<b>Question:</b> What kind of programming language is this?

<p>

<!-- code=matlab (!bc mcod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">def trapezoidal(f, a, b, n):
    # Integrate f from a to b with n intervals
    h = (b<span style="color: #666666">-</span>a)<span style="color: #666666">/</span>float(n)
    result = <span style="color: #666666">0.5*</span>f(a) <span style="color: #666666">+</span> <span style="color: #666666">0.5*</span>f(b)
    <span style="color: #008000; font-weight: bold">for</span> <span style="color: #008000">i</span> in range(<span style="color: #666666">1</span>, n):
        result <span style="color: #666666">+</span>= f(a <span style="color: #666666">+</span> <span style="color: #008000">i</span><span style="color: #666666">*</span>h)
    <span style="color: #008000; font-weight: bold">return</span> h<span style="color: #666666">*</span>result
</pre></div>
<p></p>

<p>
<a class="glyphicon glyphicon-pencil showdetails" data-toggle="collapse"
 data-target="#quiz_id_9_A" style="font-size: 80%;"></a>
&nbsp;<b>Choice A:</b>
Python
<div class="collapse-group">
<p><div class="collapse" id="quiz_id_9_A">
<img src="https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/correct.gif">
Correct!
</div></p>
</div>
</p>

<p>
<a class="glyphicon glyphicon-pencil showdetails" data-toggle="collapse"
 data-target="#quiz_id_9_B" style="font-size: 80%;"></a>
&nbsp;<b>Choice B:</b>
MATLAB or Octave
<div class="collapse-group">
<p><div class="collapse" id="quiz_id_9_B">
<img src="https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/incorrect.gif">
Wrong!
</div></p>
</div>
</p>

<p>
<a class="glyphicon glyphicon-pencil showdetails" data-toggle="collapse"
 data-target="#quiz_id_9_C" style="font-size: 80%;"></a>
&nbsp;<b>Choice C:</b>
Cython
<div class="collapse-group">
<p><div class="collapse" id="quiz_id_9_C">
<img src="https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/incorrect.gif">
Wrong!
</div></p>
</div>
</p>

<p>
<a class="glyphicon glyphicon-pencil showdetails" data-toggle="collapse"
 data-target="#quiz_id_9_D" style="font-size: 80%;"></a>
&nbsp;<b>Choice D:</b>
FORTRAN 77
<div class="collapse-group">
<p><div class="collapse" id="quiz_id_9_D">
<img src="https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/incorrect.gif">
Wrong!
</div></p>
</div>
</p>
<!-- end quiz -->


<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="decay:quiz:prog:f77">Exercise 56: Recognize a programming language</h2>

<p>
<!-- --- previous heading type: exercise -->
<!-- begin quiz -->
<hr>
<p>
<b>Question:</b> What kind of programming language is this?

<p>

<!-- code=fortran (!bc fcod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">      <span style="color: #B00040">real</span><span style="color: #666666">*8</span> <span style="color: #008000; font-weight: bold">function </span>trapezoidal(f, a, b, n)
C     Integrate f from a to b with n intervals
      <span style="color: #B00040">real</span><span style="color: #666666">*8</span> h, <span style="color: #008000; font-weight: bold">result</span>, f
      <span style="color: #008000; font-weight: bold">external </span>f
      h <span style="color: #666666">=</span> (b<span style="color: #666666">-</span>a)<span style="color: #666666">/</span>n
      <span style="color: #008000; font-weight: bold">result</span> <span style="color: #666666">=</span> <span style="color: #666666">0.5*</span>f(a) <span style="color: #666666">+</span> <span style="color: #666666">0.5*</span>f(b)
      <span style="color: #008000; font-weight: bold">do </span>i <span style="color: #666666">=</span> <span style="color: #666666">1</span>, n<span style="color: #666666">-1</span>
        <span style="color: #008000; font-weight: bold">result</span> <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">result</span> <span style="color: #666666">+</span> f(a <span style="color: #666666">+</span> i<span style="color: #666666">*</span>h)
      <span style="color: #008000; font-weight: bold">end do</span>
<span style="color: #008000; font-weight: bold">      </span>trapezoidal <span style="color: #666666">=</span> h<span style="color: #666666">*</span><span style="color: #008000; font-weight: bold">result</span>
<span style="color: #008000; font-weight: bold">      return</span>
<span style="color: #008000; font-weight: bold">      end</span>
</pre></div>
<p></p>

<p>
<a class="glyphicon glyphicon-pencil showdetails" data-toggle="collapse"
 data-target="#quiz_id_10_A" style="font-size: 80%;"></a>
&nbsp;<b>Choice A:</b>
Python
<div class="collapse-group">
<p><div class="collapse" id="quiz_id_10_A">
<img src="https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/incorrect.gif">
Wrong!
</div></p>
</div>
</p>

<p>
<a class="glyphicon glyphicon-pencil showdetails" data-toggle="collapse"
 data-target="#quiz_id_10_B" style="font-size: 80%;"></a>
&nbsp;<b>Choice B:</b>
MATLAB or Octave
<div class="collapse-group">
<p><div class="collapse" id="quiz_id_10_B">
<img src="https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/incorrect.gif">
Wrong!
</div></p>
</div>
</p>

<p>
<a class="glyphicon glyphicon-pencil showdetails" data-toggle="collapse"
 data-target="#quiz_id_10_C" style="font-size: 80%;"></a>
&nbsp;<b>Choice C:</b>
Cython
<div class="collapse-group">
<p><div class="collapse" id="quiz_id_10_C">
<img src="https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/incorrect.gif">
Wrong!
</div></p>
</div>
</p>

<p>
<a class="glyphicon glyphicon-pencil showdetails" data-toggle="collapse"
 data-target="#quiz_id_10_D" style="font-size: 80%;"></a>
&nbsp;<b>Choice D:</b>
FORTRAN 77
<div class="collapse-group">
<p><div class="collapse" id="quiz_id_10_D">
<img src="https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/correct.gif">
Correct!
</div></p>
</div>
</p>
<!-- end quiz -->


<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="decay:quiz:prog:c">Exercise 57: Recognize a programming language</h2>

<p>
<!-- --- previous heading type: exercise -->
<!-- begin quiz -->
<hr>
<p>
<b>Question:</b> What kind of programming language is this?

<p>

<!-- code=matlab (!bc mcod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">double trapezoidal(
    double (<span style="color: #666666">*</span>f)(double), double a, double b, int n)
{
    double h, result;
    h = (b<span style="color: #666666">-</span>a)<span style="color: #666666">/</span>n;
    result = <span style="color: #666666">0.5*</span>f(a) <span style="color: #666666">+</span> <span style="color: #666666">0.5*</span>f(b);
    <span style="color: #008000; font-weight: bold">for</span> (<span style="color: #008000">i</span>=<span style="color: #666666">1</span>; <span style="color: #008000">i</span><span style="color: #666666">++</span>; <span style="color: #008000">i</span> <span style="color: #666666">&lt;</span>= n<span style="color: #666666">-1</span>) {
        result <span style="color: #666666">+</span>= f(a <span style="color: #666666">+</span> <span style="color: #008000">i</span><span style="color: #666666">*</span>h);
    }
    <span style="color: #008000; font-weight: bold">return</span> h<span style="color: #666666">*</span>result;
}
</pre></div>
<p></p>

<p>
<a class="glyphicon glyphicon-pencil showdetails" data-toggle="collapse"
 data-target="#quiz_id_11_A" style="font-size: 80%;"></a>
&nbsp;<b>Choice A:</b>
C
<div class="collapse-group">
<p><div class="collapse" id="quiz_id_11_A">
<img src="https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/correct.gif">
Correct!
</div></p>
</div>
</p>

<p>
<a class="glyphicon glyphicon-pencil showdetails" data-toggle="collapse"
 data-target="#quiz_id_11_B" style="font-size: 80%;"></a>
&nbsp;<b>Choice B:</b>
C++
<div class="collapse-group">
<p><div class="collapse" id="quiz_id_11_B">
<img src="https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/incorrect.gif">
Wrong!
</div></p>
</div>
</p>

<p>
<a class="glyphicon glyphicon-pencil showdetails" data-toggle="collapse"
 data-target="#quiz_id_11_C" style="font-size: 80%;"></a>
&nbsp;<b>Choice C:</b>
Cython
<div class="collapse-group">
<p><div class="collapse" id="quiz_id_11_C">
<img src="https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/incorrect.gif">
Wrong!
</div></p>
</div>
</p>

<p>
<a class="glyphicon glyphicon-pencil showdetails" data-toggle="collapse"
 data-target="#quiz_id_11_D" style="font-size: 80%;"></a>
&nbsp;<b>Choice D:</b>
Octave dialect
<div class="collapse-group">
<p><div class="collapse" id="quiz_id_11_D">
<img src="https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/incorrect.gif">
Wrong!
</div></p>
</div>
</p>
<!-- end quiz -->


<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="decay:quiz:sympy1">Exercise 58: What is SymPy?</h2>

<p>
<!-- --- previous heading type: exercise -->
<!-- begin quiz -->
<hr>
<p>
<b>Question:</b> What is SymPy?</p>

<p>
<a class="glyphicon glyphicon-pencil showdetails" data-toggle="collapse"
 data-target="#quiz_id_12_A" style="font-size: 80%;"></a>
&nbsp;<b>Choice A:</b>
A Python module for computing with symmetric matrices.
<div class="collapse-group">
<p><div class="collapse" id="quiz_id_12_A">
<img src="https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/incorrect.gif">
SymPy can compute with symmetric matrices, so that is true, but it can do very much more.
</div></p>
</div>
</p>

<p>
<a class="glyphicon glyphicon-pencil showdetails" data-toggle="collapse"
 data-target="#quiz_id_12_B" style="font-size: 80%;"></a>
&nbsp;<b>Choice B:</b>
A Python package for doing symbolic computations (exact/analytical differentiation, integration, equation solves, etc.).
<div class="collapse-group">
<p><div class="collapse" id="quiz_id_12_B">
<img src="https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/correct.gif">
Correct!
</div></p>
</div>
</p>

<p>
<a class="glyphicon glyphicon-pencil showdetails" data-toggle="collapse"
 data-target="#quiz_id_12_C" style="font-size: 80%;"></a>
&nbsp;<b>Choice C:</b>
A Python package for numerical approximations to differentiation, integration, equation solving, etc.
<div class="collapse-group">
<p><div class="collapse" id="quiz_id_12_C">
<img src="https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/incorrect.gif">
It's the opposite: analytical, not numerical.
</div></p>
</div>
</p>

<p>
<a class="glyphicon glyphicon-pencil showdetails" data-toggle="collapse"
 data-target="#quiz_id_12_D" style="font-size: 80%;"></a>
&nbsp;<b>Choice D:</b>
A free, open source version of Mathematica.
<div class="collapse-group">
<p><div class="collapse" id="quiz_id_12_D">
<img src="https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/incorrect.gif">
Could be viewed as such, but Mathematica is a much more advanced tool for symbolic computing.
</div></p>
</div>
</p>
<!-- end quiz -->


<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="decay:quiz:testing1">Exercise 59: Testing of code</h2>

<p>
<!-- --- previous heading type: exercise -->
<!-- begin quiz -->
<hr>
<p>
<b>Question:</b> What is an appropriate test for computing the solution of some ODE?</p>

<p>
<a class="glyphicon glyphicon-pencil showdetails" data-toggle="collapse"
 data-target="#quiz_id_13_A" style="font-size: 80%;"></a>
&nbsp;<b>Choice A:</b>
We compare the numerical solution with the analytical solution
in a plot. The curves are quite close, showing that the computations
are correct (here using 31 mesh points).

<p>
<center><p><img src="fig-quiz/comparison_num_vs_exact_quiz.png" align="bottom" width=500></p></center>
<div class="collapse-group">
<p><div class="collapse" id="quiz_id_13_A">
<img src="https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/incorrect.gif">
This comparison says nothing if the discrepancy is the unavoidable
numerical error or if it also contains the effect of bugs in the program.
</div></p>
</div>
</p>

<p>
<a class="glyphicon glyphicon-pencil showdetails" data-toggle="collapse"
 data-target="#quiz_id_13_B" style="font-size: 80%;"></a>
&nbsp;<b>Choice B:</b>
The maximum error between the numerical and exact solution at
the mesh points is \( 1.886\cdot 10^{-5} \), which is small. Therefore, the
program works.
<div class="collapse-group">
<p><div class="collapse" id="quiz_id_13_B">
<img src="https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/incorrect.gif">
Nobody knows if this is the numerical approximation error or if it
also contains programming errors.
</div></p>
</div>
</p>

<p>
<a class="glyphicon glyphicon-pencil showdetails" data-toggle="collapse"
 data-target="#quiz_id_13_C" style="font-size: 80%;"></a>
&nbsp;<b>Choice C:</b>
The scheme is \( \Oof{\Delta t^2} \). With 31 points we get a maximum
point-wise error of \( 1.243\cdot 10^{-4} \). With 61 points (halving \( \Delta t \))
the corresponding error is \( 3.108\cdot 10^{-5} \). This is a reduction of
approximately a factor 4, which is what we expect for such a scheme when
halving \( \Delta t \).
<div class="collapse-group">
<p><div class="collapse" id="quiz_id_13_C">
<img src="https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/correct.gif">
This test involves checking of the convergence rate, which is a good
test. The only knowledge we have of the numerical error is its rate!
</div></p>
</div>
</p>

<p>
<a class="glyphicon glyphicon-pencil showdetails" data-toggle="collapse"
 data-target="#quiz_id_13_D" style="font-size: 80%;"></a>
&nbsp;<b>Choice D:</b>
The numerical solution and the exact solutions get closer and closer
in a plot as we reduce \( \Delta t \). Therefore, the program works.
<div class="collapse-group">
<p><div class="collapse" id="quiz_id_13_D">
<img src="https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/incorrect.gif">
This test points to convergence of the method, but the error can
still contain the effect of bugs. One needs to measure <em>how fast</em>
the curves get closer and closer.
</div></p>
</div>
</p>
<!-- end quiz -->


<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="decay:quiz:scheme:CN_error">Exercise 60: What kind of scheme is this?</h2>

<p>
<!-- --- previous heading type: exercise -->
<!-- begin quiz -->
<hr>
<p>
<b>Question:</b> Given \( u^{\prime}=-au + b \), where \( a \) and \( b \) are functions of time.
Is the following scheme correct?

$$ \frac{u^{n}-u^{n-1}}{\Delta t} = -a(t_n)\frac{1}{2}(u^n + u^{n-1})
+ b(t_n)\tp$$</p>

<p>
<a class="glyphicon glyphicon-pencil showdetails" data-toggle="collapse"
 data-target="#quiz_id_14_A" style="font-size: 80%;"></a>
&nbsp;<b>Choice A:</b>
Yes, it is a Crank-Nicolson type of scheme.
<div class="collapse-group">
<p><div class="collapse" id="quiz_id_14_A">
<img src="https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/incorrect.gif">
No, then \( a \) and \( b \) should have been evaluated at \( t_{n-1/2} \).
</div></p>
</div>
</p>

<p>
<a class="glyphicon glyphicon-pencil showdetails" data-toggle="collapse"
 data-target="#quiz_id_14_B" style="font-size: 80%;"></a>
&nbsp;<b>Choice B:</b>
Yes, if \( a(t_n) \) and \( b(t_n) \) are evaluated at the previous time
step, \( a(t_{n-1}) \) and \( a(t_{n-1}) \).
<div class="collapse-group">
<p><div class="collapse" id="quiz_id_14_B">
<img src="https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/incorrect.gif">
No, this will be wrong since the arithmetic mean on the right-hand
side points sampling the ODE at \( t_{n-1/2} \). Then \( a \) and \( b \) must
be evaluated at this point.
</div></p>
</div>
</p>

<p>
<a class="glyphicon glyphicon-pencil showdetails" data-toggle="collapse"
 data-target="#quiz_id_14_C" style="font-size: 80%;"></a>
&nbsp;<b>Choice C:</b>
No, the coefficients \( a \) and \( b \) are not evaluated correctly.
<div class="collapse-group">
<p><div class="collapse" id="quiz_id_14_C">
<img src="https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/correct.gif">
That is right: they should be evaluated at \( t_{n-1/2} \).
</div></p>
</div>
</p>

<p>
<a class="glyphicon glyphicon-pencil showdetails" data-toggle="collapse"
 data-target="#quiz_id_14_D" style="font-size: 80%;"></a>
&nbsp;<b>Choice D:</b>
No, the right-hand side should be \( a(t_n)u^n + b(t_n) \).
<div class="collapse-group">
<p><div class="collapse" id="quiz_id_14_D">
<img src="https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/incorrect.gif">
That is right if the scheme should be a Backward Euler scheme, but
the arithmetic mean on the right-hand side points to a Crank-Nicolson
scheme, though with wrong sampling of \( a \) and \( b \).
</div></p>
</div>
</p>
<!-- end quiz -->


<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="decay:quiz:scheme:BE">Exercise 61: What kind of scheme is this?</h2>

<p>
<!-- --- previous heading type: exercise -->
<!-- begin quiz -->
<hr>
<p>
<b>Question:</b> We want to solve \( y'=g(x, y) \) for \( y(x) \) and have the scheme

$$ y^{i+1} = y^i + \Delta t\, g(x_{i+1}, y^{i+1})\tp$$

<p>
What is this scheme called?</p>

<p>
<a class="glyphicon glyphicon-pencil showdetails" data-toggle="collapse"
 data-target="#quiz_id_15_A" style="font-size: 80%;"></a>
&nbsp;<b>Choice A:</b>
The implicit midpoint scheme.
<div class="collapse-group">
<p><div class="collapse" id="quiz_id_15_A">
<img src="https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/incorrect.gif">
There is no midpoint \( i+1/2 \) involved here.
</div></p>
</div>
</p>

<p>
<a class="glyphicon glyphicon-pencil showdetails" data-toggle="collapse"
 data-target="#quiz_id_15_B" style="font-size: 80%;"></a>
&nbsp;<b>Choice B:</b>
The Backward Euler scheme or just the backward scheme.
<div class="collapse-group">
<p><div class="collapse" id="quiz_id_15_B">
<img src="https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/correct.gif">
Correct!
</div></p>
</div>
</p>

<p>
<a class="glyphicon glyphicon-pencil showdetails" data-toggle="collapse"
 data-target="#quiz_id_15_C" style="font-size: 80%;"></a>
&nbsp;<b>Choice C:</b>
The Forward Euler scheme, Euler's method, or just the forward scheme.
<div class="collapse-group">
<p><div class="collapse" id="quiz_id_15_C">
<img src="https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/incorrect.gif">
This is true if we had \( g(x_i, y^{i}) \).
</div></p>
</div>
</p>

<p>
<a class="glyphicon glyphicon-pencil showdetails" data-toggle="collapse"
 data-target="#quiz_id_15_D" style="font-size: 80%;"></a>
&nbsp;<b>Choice D:</b>
The implicit Adams scheme of order one.
<div class="collapse-group">
<p><div class="collapse" id="quiz_id_15_D">
<img src="https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/incorrect.gif">
Wrong!
</div></p>
</div>
</p>
<!-- end quiz -->


<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="decay:quiz:scheme:leapfrog">Exercise 62: What kind of scheme is this?</h2>

<p>
<!-- --- previous heading type: exercise -->
<!-- begin quiz -->
<hr>
<p>
<b>Question:</b> We want to solve \( y'=g(x, y) \) for \( y(x) \) and have the scheme

$$ y^{i+1} = y^{i-1} + 2\Delta t\, g(x_{i}, y^{i})\tp$$

<p>
What is this scheme called?</p>

<p>
<a class="glyphicon glyphicon-pencil showdetails" data-toggle="collapse"
 data-target="#quiz_id_16_A" style="font-size: 80%;"></a>
&nbsp;<b>Choice A:</b>
The implicit midpoint scheme.
<div class="collapse-group">
<p><div class="collapse" id="quiz_id_16_A">
<img src="https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/incorrect.gif">
It is a midpoint scheme, but it is explicit rather than implicit.
</div></p>
</div>
</p>

<p>
<a class="glyphicon glyphicon-pencil showdetails" data-toggle="collapse"
 data-target="#quiz_id_16_B" style="font-size: 80%;"></a>
&nbsp;<b>Choice B:</b>
The two-step backward scheme.
<div class="collapse-group">
<p><div class="collapse" id="quiz_id_16_B">
<img src="https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/incorrect.gif">
Wrong!
</div></p>
</div>
</p>

<p>
<a class="glyphicon glyphicon-pencil showdetails" data-toggle="collapse"
 data-target="#quiz_id_16_C" style="font-size: 80%;"></a>
&nbsp;<b>Choice C:</b>
The Crank-Nicolson scheme.
<div class="collapse-group">
<p><div class="collapse" id="quiz_id_16_C">
<img src="https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/incorrect.gif">
No, that looks quite different and is based on a centered difference
over \( [x_i,x_{i+1}] \), not \( [x_{i-1},x_{i+1}] \).
</div></p>
</div>
</p>

<p>
<a class="glyphicon glyphicon-pencil showdetails" data-toggle="collapse"
 data-target="#quiz_id_16_D" style="font-size: 80%;"></a>
&nbsp;<b>Choice D:</b>
The leapfrog scheme.
<div class="collapse-group">
<p><div class="collapse" id="quiz_id_16_D">
<img src="https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/correct.gif">
Correct!
</div></p>
</div>
</p>
<!-- end quiz -->


<p>
<!-- --- end exercise --- -->

<p>
<p>
<!-- navigation buttons at the bottom of the page -->
<ul class="pager">
  <li class="previous">
    <a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86009.html">&larr; Prev</a>
  </li>
  <li class="next">
    <a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86011.html">Next &rarr;</a>
  </li>
</ul>
<!-- ------------------- end of main content --------------- -->

</div>  <!-- end container -->
<!-- include javascript, jQuery *first* -->
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script src="http://netdna.bootstrapcdn.com/bootstrap/3.0.0/js/bootstrap.min.js"></script>

<!-- Bootstrap footer
<footer>
<a href="http://..."><img width="250" align=right src="http://..."></a>
</footer>
-->


<center style="font-size:80%">
<!-- copyright only on the titlepage -->
</center>


</body>
</html>
    


<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Appendix: Useful formulas</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="_static/sidebar.js"></script>

        <script src="http://sagecell.sagemath.org/static/jquery.min.js"></script>
        <script src="http://sagecell.sagemath.org/static/embedded_sagecell.js"></script>

        <script>sagecell.makeSagecell({inputLocation: ".sage"});</script>

        <style type="text/css">
                .sagecell .CodeMirror-scroll {
                        overflow-y: hidden;
                        overflow-x: auto;
                }
                .sagecell .CodeMirror {
                        height: auto;
                }
        </style>

    
    <link rel="top" title="Finite Difference Computing with Partial Differential Equations" href="index.html" />
    <link rel="next" title="Appendix: Truncation error analysis" href="._book011.html" />
    <link rel="prev" title="Staggered mesh discretization" href="._book009.html" />
 
  
       <style type="text/css">
         div.admonition {
           background-color: whiteSmoke;
           border: 1px solid #bababa;
         }
       </style>
      </head>
    
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="._book011.html" title="Appendix: Truncation error analysis"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="._book009.html" title="Staggered mesh discretization"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Finite Difference Computing with Partial Differential Equations</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="appendix-useful-formulas">
<h1>Appendix: Useful formulas<a class="headerlink" href="#appendix-useful-formulas" title="Permalink to this headline">¶</a></h1>
<div class="section" id="finite-difference-operator-notation">
<span id="sec-form-fdop"></span><h2>Finite difference operator notation<a class="headerlink" href="#finite-difference-operator-notation" title="Permalink to this headline">¶</a></h2>
<div class="math" id="eq-dop-fd1-center">
\[\tag{393}
u'(t_n) \approx
    \lbrack D_tu\rbrack^n = \frac{u^{n+\half} - u^{n-\half}}{\Delta t}\]</div>
<div class="math" id="eq-dop-fd1-center2">
\[\tag{394}
u'(t_n) a\approx
    \lbrack D_{2t}u\rbrack^n = \frac{u^{n+1} - u^{n-1}}{2\Delta t} +\]</div>
<div class="math" id="eq-dop-fd1-bw">
\[\tag{395}
u'(t_n) =
    \lbrack D_t^-u\rbrack^n = \frac{u^{n} - u^{n-1}}{\Delta t}\]</div>
<div class="math" id="eq-dop-fd1-fw">
\[\tag{396}
u'(t_n) \approx
    \lbrack D_t^+u\rbrack^n = \frac{u^{n+1} - u^{n}}{\Delta t}\]</div>
<div class="math" id="eq-dop-fd1-theta">
\[\tag{397}
u'(t_{n+\theta}) =
    \lbrack \bar D_tu\rbrack^{n+\theta} = \frac{u^{n+1} - u^{n}}{\Delta t}\]</div>
<div class="math" id="eq-dop-fd1-bw2">
\[\tag{398}
u'(t_n) \approx
    \lbrack D_t^{2-}u\rbrack^n = \frac{3u^{n} - 4u^{n-1} + u^{n-2}}{2\Delta t}\]</div>
<div class="math" id="eq-dop-fd2-center">
\[\tag{399}
u''(t_n) \approx
    \lbrack D_tD_t u\rbrack^n = \frac{u^{n+1} - 2u^{n} + u^{n-1}}{\Delta t^2}\]</div>
<div class="math" id="eq-dop-avg-arith">
\[\tag{400}
u(t_{n+\half}) \approx \lbrack \overline{u}^{t}\rbrack^{n+\half}
    = \half(u^{n+1} + u^n)\]</div>
<div class="math" id="eq-dop-avg-geom">
\[\tag{401}
u(t_{n+\half})^2 \approx \lbrack \overline{u^2}^{t,g}\rbrack^{n+\half}
    = u^{n+1}u^n\]</div>
<div class="math" id="eq-dop-avg-harm">
\[\tag{402}
u(t_{n+\half}) \approx \lbrack \overline{u}^{t,h}\rbrack^{n+\half}
    = 2\frac{\frac{1}{u^{n+1}} + \frac{1}{u^n}}\]</div>
<div class="math" id="eq-dop-avg-theta">
\[\tag{403}
u(t_{n+\theta}) \approx \lbrack \overline{u}^{t,\theta}\rbrack^{n+\theta}
    = \theta u^{n+1} + (1-\theta)u^n ,\quad t_{n+\theta}=\theta t_{n+1} + (1-\theta)t_{n-1}\]</div>
</div>
<div class="section" id="truncation-errors-of-finite-difference-approximations">
<span id="sec-form-truncerr"></span><h2>Truncation errors of finite difference approximations<a class="headerlink" href="#truncation-errors-of-finite-difference-approximations" title="Permalink to this headline">¶</a></h2>
<div class="math">
\[\uex'(t_n) =
[D_t\uex]^n + R^n = \frac{\uex^{n+\half} - \uex^{n-\half}}{\Delta t} +R^n\nonumber,\]</div>
<div class="math" id="eq-form-trunc-fd1-center">
\[\tag{404}
R^n = -\frac{1}{24}\uex'''(t_n)\Delta t^2 + {\cal O}(\Delta t^4)\]</div>
<div class="math">
\[\uex'(t_n) =
[D_{2t}\uex]^n +R^n = \frac{\uex^{n+1} - \uex^{n-1}}{2\Delta t} +
R^n\nonumber,\]</div>
<div class="math" id="eq-form-trunc-fd1-center2">
\[\tag{405}
R^n = -\frac{1}{6}\uex'''(t_n)\Delta t^2 + {\cal O}(\Delta t^4)\]</div>
<div class="math">
\[\uex'(t_n) =
[D_t^-\uex]^n +R^n = \frac{\uex^{n} - \uex^{n-1}}{\Delta t}
+R^n\nonumber,\]</div>
<div class="math" id="eq-form-trunc-fd1-bw">
\[\tag{406}
R^n = -\half\uex''(t_n)\Delta t + {\cal O}(\Delta t^2)\]</div>
<div class="math">
\[\uex'(t_n) =
[D_t^+\uex]^n +R^n = \frac{\uex^{n+1} - \uex^{n}}{\Delta t}
+R^n\nonumber,\]</div>
<div class="math" id="eq-form-trunc-fd1-fw">
\[\tag{407}
R^n = -\half\uex''(t_n)\Delta t + {\cal O}(\Delta t^2)\]</div>
<div class="math">
\[\uex'(t_{n+\theta}) =
[\bar D_t\uex]^{n+\theta} +R^{n+\theta} = \frac{\uex^{n+1} - \uex^{n}}{\Delta t}
+R^{n+\theta}\nonumber,\]</div>
<div class="math">
\[R^{n+\theta} = -\half(1-2\theta)\uex''(t_{n+\theta})\Delta t +
\frac{1}{6}((1 - \theta)^3 - \theta^3)\uex'''(t_{n+\theta})\Delta t^2 +
\nonumber\]</div>
<div class="math" id="eq-form-trunc-fd1-theta">
\[\tag{408}
\quad {\cal O}(\Delta t^3)\]</div>
<div class="math">
\[\uex'(t_n) =
[D_t^{2-}\uex]^n +R^n = \frac{3\uex^{n} - 4\uex^{n-1} + \uex^{n-2}}{2\Delta t}
+R^n\nonumber,\]</div>
<div class="math" id="eq-form-trunc-fd1-bw2">
\[\tag{409}
R^n = \frac{1}{3}\uex'''(t_n)\Delta t^2 + {\cal O}(\Delta t^3)\]</div>
<div class="math">
\[\uex''(t_n) =
[D_tD_t \uex]^n +R^n = \frac{\uex^{n+1} - 2\uex^{n} + \uex^{n-1}}{\Delta t^2}
+R^n\nonumber,\]</div>
<div class="math" id="eq-form-trunc-fd2-center">
\[\tag{410}
R^n = -\frac{1}{12}\uex''''(t_n)\Delta t^2 + {\cal O}(\Delta t^4)\]</div>
<div class="math">
\[\uex(t_{n+\theta}) = [\overline{\uex}^{t,\theta}]^{n+\theta} +R^{n+\theta}
= \theta \uex^{n+1} + (1-\theta)\uex^n +R^{n+\theta},\nonumber\]</div>
<div class="math" id="eq-form-trunc-avg-theta">
\[\tag{411}
R^{n+\theta} = -\half\uex''(t_{n+\theta})\Delta t^2\theta (1-\theta) +
    {\cal O}(\Delta t^3)
    \tp\]</div>
</div>
<div class="section" id="finite-differences-of-exponential-functions">
<span id="sec-form-fdexp"></span><h2>Finite differences of exponential functions<a class="headerlink" href="#finite-differences-of-exponential-functions" title="Permalink to this headline">¶</a></h2>
<div class="section" id="complex-exponentials">
<h3>Complex exponentials<a class="headerlink" href="#complex-exponentials" title="Permalink to this headline">¶</a></h3>
<p>Let <span class="math">\(u^n = \exp{(i\omega n\Delta t)} = e^{i\omega t}\)</span>.</p>
<div class="math" id="eq-form-exp-fd2-center">
\[\tag{412}
[D_tD_t u]^n = u^n \frac{2}{\Delta t}(\cos \omega\Delta t - 1) =
    -\frac{4}{\Delta t}\sin^2\left(\frac{\omega\Delta t}{2}\right),\]</div>
<div class="math" id="eq-form-exp-fd1-fw">
\[\tag{413}
[D_t^+ u]^n = u^n\frac{1}{\Delta t}(\exp{(i\omega\Delta t)} - 1),\]</div>
<div class="math" id="eq-form-exp-fd1-bw">
\[\tag{414}
[D_t^- u]^n = u^n\frac{1}{\Delta t}(1 - \exp{(-i\omega\Delta t)}),\]</div>
<div class="math" id="eq-form-exp-fd1-center">
\[\tag{415}
[D_t u]^n = u^n\frac{2}{\Delta t}i\sin{\left(\frac{\omega\Delta t}{2}\right)},\]</div>
<div class="math" id="eq-form-exp-fd1c-center">
\[\tag{416}
[D_{2t} u]^n = u^n\frac{1}{\Delta t}i\sin{(\omega\Delta t)}\]\[    \tp\]</div>
</div>
<div class="section" id="real-exponentials">
<h3>Real exponentials<a class="headerlink" href="#real-exponentials" title="Permalink to this headline">¶</a></h3>
<p>Let <span class="math">\(u^n = \exp{(\omega n\Delta t)} = e^{\omega t}\)</span>.</p>
<div class="math" id="eq-form-rexp-fd2-center">
\[\tag{417}
[D_tD_t u]^n = u^n \frac{2}{\Delta t}(\cos \omega\Delta t - 1) =
    -\frac{4}{\Delta t}\sin^2\left(\frac{\omega\Delta t}{2}\right),\]</div>
<div class="math" id="eq-form-rexp-fd1-fw">
\[\tag{418}
[D_t^+ u]^n = u^n\frac{1}{\Delta t}(\exp{(i\omega\Delta t)} - 1),\]</div>
<div class="math" id="eq-form-rexp-fd1-bw">
\[\tag{419}
[D_t^- u]^n = u^n\frac{1}{\Delta t}(1 - \exp{(-i\omega\Delta t)}),\]</div>
<div class="math" id="eq-form-rexp-fd1-center">
\[\tag{420}
[D_t u]^n = u^n\frac{2}{\Delta t}i\sin{\left(\frac{\omega\Delta t}{2}\right)},\]</div>
<div class="math" id="eq-form-rexp-fd1c-center">
\[\tag{421}
[D_{2t} u]^n = u^n\frac{1}{\Delta t}i\sin{(\omega\Delta t)}\]\[    \tp\]</div>
</div>
</div>
<div class="section" id="finite-differences-of">
<span id="sec-form-fdtn"></span><h2>Finite differences of <span class="math">\(t^n\)</span><a class="headerlink" href="#finite-differences-of" title="Permalink to this headline">¶</a></h2>
<p>The following results are useful when checking if a polynomial term in a
solution fulfills the discrete equation for the numerical method.</p>
<div class="math" id="eq-form-dop-tn-fw">
\[\tag{422}
\lbrack D_t^+ t\rbrack^n = 1,\]</div>
<div class="math" id="eq-form-dop-tn-bw">
\[\tag{423}
\lbrack D_t^- t\rbrack^n = 1,\]</div>
<div class="math">
\[\lbrack D_t t\rbrack^n = 1,\]\[\lbrack D_{2t} t\rbrack^n = 1,\]\[\lbrack D_{t}D_t t\rbrack^n = 0\]\[\tp\]</div>
<p>The next formulas concern the action of difference operators on a <span class="math">\(t^2\)</span> term.</p>
<div class="math" id="eq-form-dop-tn2-fw">
\[\tag{424}
\lbrack D_t^+ t^2\rbrack^n = (2n+1)\Delta t,\]</div>
<div class="math" id="eq-form-dop-tn2-bw">
\[\tag{425}
\lbrack D_t^- t^2\rbrack^n = (2n-1)\Delta t,\]</div>
<div class="math">
\[\lbrack D_t t^2\rbrack^n = 2n\Delta t,\]\[\lbrack D_{2t} t^2\rbrack^n = 2n\Delta t,\]\[\lbrack D_{t}D_t t^2\rbrack^n = 2,\]</div>
<p>Finally, we present formulas for a <span class="math">\(t^3\)</span> term: <strong>These must be controlled</strong>
against <code class="docutils literal"><span class="pre">lib.py</span></code>. Use <span class="math">\(t_n\)</span> instead of <span class="math">\(n\Delta t\)</span>??</p>
<div class="math" id="eq-form-dop-tn3-fw">
\[\tag{426}
\lbrack D_t^+ t^3\rbrack^n = 3(n\Delta t)^2 + 3n\Delta t^2 + \Delta t^2,\]</div>
<div class="math" id="eq-form-dop-tn3-bw">
\[\tag{427}
\lbrack D_t^- t^3\rbrack^n = 3(n\Delta t)^2 - 3n\Delta t^2 + \Delta t^2,\]</div>
<div class="math" id="eq-form-dop-tn3-cn">
\[\tag{428}
\lbrack D_t t^3\rbrack^n = 3(n\Delta t)^2 + \frac{1}{4}\Delta t^2,\]</div>
<div class="math" id="eq-form-dop-tn3-2cn">
\[\tag{429}
\lbrack D_{2t} t^3\rbrack^n = 3(n\Delta t)^2 + \Delta t^2,\]</div>
<div class="math" id="eq-form-dop2-tn3-cn">
\[\tag{430}
\lbrack D_{t}D_t t^3\rbrack^n = 6n\Delta t,\]</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <center>
            <p class="logo"><a href="http://cbc.simula.no/" title="Go to Center for Biomedical Computing">
              <img class="logo" src="_static/cbc_logo.png" alt="Logo"/>
            </a></p>
            </center>
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Appendix: Useful formulas</a><ul>
<li><a class="reference internal" href="#finite-difference-operator-notation">Finite difference operator notation</a></li>
<li><a class="reference internal" href="#truncation-errors-of-finite-difference-approximations">Truncation errors of finite difference approximations</a></li>
<li><a class="reference internal" href="#finite-differences-of-exponential-functions">Finite differences of exponential functions</a><ul>
<li><a class="reference internal" href="#complex-exponentials">Complex exponentials</a></li>
<li><a class="reference internal" href="#real-exponentials">Real exponentials</a></li>
</ul>
</li>
<li><a class="reference internal" href="#finite-differences-of">Finite differences of <span class="math">\(t^n\)</span></a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="._book009.html"
                        title="previous chapter">Staggered mesh discretization</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="._book011.html"
                        title="next chapter">Appendix: Truncation error analysis</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/._book010.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="._book011.html" title="Appendix: Truncation error analysis"
             >next</a> |</li>
        <li class="right" >
          <a href="._book009.html" title="Staggered mesh discretization"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Finite Difference Computing with Partial Differential Equations</a> &raquo;</li> 
      </ul>
    </div>
<div class="wrapper">
  <div class="footer">
    <a href="http://cbc.simula.no"><img src="_static/cbc_banner.png" width="100%"><a>
    <br />
    <br />
      &copy;2015, Hans Petter Langtangen. Released under CC Attribution 4.0 license.
  </div>
</div>

  </body>
</html>
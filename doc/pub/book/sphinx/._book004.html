

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Exercises (1)</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="_static/sidebar.js"></script>

        <script src="http://sagecell.sagemath.org/static/jquery.min.js"></script>
        <script src="http://sagecell.sagemath.org/static/embedded_sagecell.js"></script>

        <script>sagecell.makeSagecell({inputLocation: ".sage"});</script>

        <style type="text/css">
                .sagecell .CodeMirror-scroll {
                        overflow-y: hidden;
                        overflow-x: auto;
                }
                .sagecell .CodeMirror {
                        height: auto;
                }
        </style>

    
    <link rel="top" title="Finite Difference Computing with Exponential Decay Models" href="index.html" />
    <link rel="next" title="Analysis" href="._book005.html" />
    <link rel="prev" title="Implementation (1)" href="._book003.html" />
 
  
       <style type="text/css">
         div.admonition {
           background-color: whiteSmoke;
           border: 1px solid #bababa;
         }
       </style>
      </head>
    
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="._book005.html" title="Analysis"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="._book003.html" title="Implementation (1)"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">Finite Difference Computing with Exponential Decay Models</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="exercises-1">
<h1>Exercises  (1)<a class="headerlink" href="#exercises-1" title="Permalink to this headline">¶</a></h1>
<div class="section" id="exercise-1-define-a-mesh-function-and-visualize-it">
<span id="decay-exer-meshfunc"></span><h2>Exercise 1: Define a mesh function and visualize it<a class="headerlink" href="#exercise-1-define-a-mesh-function-and-visualize-it" title="Permalink to this headline">¶</a></h2>
<p><strong>a)</strong>
Write a function <code class="docutils literal"><span class="pre">mesh_function(f,</span> <span class="pre">t)</span></code> that returns an array with
mesh point values <span class="math">\(f(t_0),\ldots,f(t_{N_t})\)</span>, where <code class="docutils literal"><span class="pre">f</span></code> is a Python
function implementing a mathematical function <code class="docutils literal"><span class="pre">f(t)</span></code> and <span class="math">\(t_0,\ldots,t_{N_t}\)</span>
are mesh points stored in the array <code class="docutils literal"><span class="pre">t</span></code>. Use a loop over the mesh
points and compute one mesh function value at the time.</p>
<p><strong>Solution.</strong>
The function may look like</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">mesh_function</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
    <span class="n">u</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>  <span class="c"># or t.size</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)):</span>
        <span class="n">u</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">u</span>
</pre></div>
</div>
<p><strong>b)</strong>
Use <code class="docutils literal"><span class="pre">mesh_function</span></code> to compute the mesh function corresponding to</p>
<div class="math">
\[\begin{split}f(t) = \left\lbrace
\begin{array}{ll}
e^{-t},&amp; 0\leq t\leq 3,\\
e^{-3t}, &amp; 3 &lt; t\leq 4
\end{array}\right.\end{split}\]</div>
<p>Choose a mesh <span class="math">\(t_n=n\Delta t\)</span> with <span class="math">\(\Delta t=0.1\)</span>.
Plot the mesh function.</p>
<p><strong>Solution.</strong>
An appropriate function is</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">demo</span><span class="p">():</span>
    <span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">t</span> <span class="o">&lt;=</span> <span class="mi">3</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">t</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>

    <span class="c"># Compute mesh and mesh function</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">41</span><span class="p">)</span>
    <span class="n">u</span> <span class="o">=</span> <span class="n">mesh_function</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>

    <span class="c"># Plot</span>
    <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">u</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;t&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;mesh function&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">&#39;tmp.png&#39;</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">&#39;tmp.pdf&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>Filename: <code class="docutils literal"><span class="pre">mesh_function</span></code>.</p>
<div class="section" id="remarks-1">
<h3>Remarks  (1)<a class="headerlink" href="#remarks-1" title="Permalink to this headline">¶</a></h3>
<p>In the section <a class="reference internal" href="._book003.html#decay-computing-error"><span class="std std-ref">Computing the numerical error as a mesh function</span></a> we show how easy it is to
compute a mesh function by array arithmetics (or array computing).
Using this technique, one could simply implement <code class="docutils literal"><span class="pre">mesh_function(f,t)</span></code>
as <code class="docutils literal"><span class="pre">return</span> <span class="pre">f(t)</span></code>. However, <code class="docutils literal"><span class="pre">f(t)</span></code> will not work if there are
if tests involving <code class="docutils literal"><span class="pre">t</span></code> inside <code class="docutils literal"><span class="pre">f</span></code> as is the case in b). Typically,
<code class="docutils literal"><span class="pre">if</span> <span class="pre">t</span> <span class="pre">&lt;</span> <span class="pre">3</span></code> must have <code class="docutils literal"><span class="pre">t</span> <span class="pre">&lt;</span> <span class="pre">3</span></code> as a boolean expression, but if <code class="docutils literal"><span class="pre">t</span></code> is
array, <code class="docutils literal"><span class="pre">t</span> <span class="pre">&lt;</span> <span class="pre">3</span></code>, is an <em>array of boolean values</em>, which is not legal
as a boolean expression in an if test.
Computing one element
at a time as suggested in a) is a way of out of this problem.</p>
<p>We also remark that the function in b) is the solution of <span class="math">\(u^{\prime}=-au\)</span>,
<span class="math">\(u(0)=1\)</span>, for <span class="math">\(t\in [0,4]\)</span>, where <span class="math">\(a=1\)</span> for <span class="math">\(t\in [0,3]\)</span> and <span class="math">\(a=3\)</span> for
<span class="math">\(t\in [3,4]\)</span>.</p>
</div>
</div>
<div class="section" id="exercise-2-differentiate-a-function">
<span id="decay-exer-dudt"></span><h2>Exercise 2: Differentiate a function<a class="headerlink" href="#exercise-2-differentiate-a-function" title="Permalink to this headline">¶</a></h2>
<span class="target" id="index-0"></span><span class="target" id="index-1"></span><p id="index-2">Given a mesh function <span class="math">\(u^n\)</span> as an array <code class="docutils literal"><span class="pre">u</span></code> with <span class="math">\(u^n\)</span> values at mesh
points <span class="math">\(t_n=n\Delta t\)</span>, the discrete derivative can be based on
centered differences:</p>
<div class="math" id="equation-decay:exer:dudt:D2t">
<span id="eq-decay-exer-dudt-d2t"></span><span class="eqno">(1)</span>\[     d^n = [D_{2t}u]^n =
     \frac{u^{n+1}-u^{n-1}}{2\Delta t},\quad n=1,\ldots,N_t-1\tp\]</div>
<p>At the end points we use forward and backward differences:</p>
<div class="math">
\[d^0 = [D_t^+u]^n = \frac{u^{1}-u^{0}}{\Delta t},\]</div>
<p>and</p>
<div class="math">
\[d^{N_t} = [D_t^-u]^n = \frac{u^{N_t}-u^{N_t-1}}{\Delta t}\tp\]</div>
<p><strong>a)</strong>
Write a function
<code class="docutils literal"><span class="pre">differentiate(u,</span> <span class="pre">dt)</span></code> that returns the discrete derivative <span class="math">\(d^n\)</span> of the
mesh function <span class="math">\(u^n\)</span>. The parameter <code class="docutils literal"><span class="pre">dt</span></code> reflects the
mesh spacing <span class="math">\(\Delta t\)</span>. Write a corresponding test function
<code class="docutils literal"><span class="pre">test_differentiate()</span></code> for verifying the implementation.</p>
<p><strong>Hint.</strong>
The three differentiation formulas are
exact for quadratic polynomials. Use this property to verify the program.</p>
<p><strong>Solution.</strong>
The functions can be written as</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>

<span class="k">def</span> <span class="nf">differentiate</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">dt</span><span class="p">):</span>
    <span class="n">dudt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">u</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">dudt</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">dudt</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">u</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">dt</span><span class="p">)</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">dudt</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">u</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">/</span><span class="n">dt</span>
    <span class="n">i</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">dudt</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>
    <span class="n">dudt</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">u</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="n">dt</span>
    <span class="k">return</span> <span class="n">dudt</span>

<span class="k">def</span> <span class="nf">test_differentiate</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Test differentiate with a linear u.&quot;&quot;&quot;</span>
    <span class="c"># Expect exact results</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
    <span class="n">u</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="mi">7</span>
    <span class="n">dudt</span> <span class="o">=</span> <span class="n">differentiate</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">diff</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">dudt</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
    <span class="n">tol</span> <span class="o">=</span> <span class="mf">1E-15</span>
    <span class="k">assert</span> <span class="n">diff</span> <span class="o">&lt;</span> <span class="n">tol</span>
</pre></div>
</div>
<p><strong>b)</strong>
A standard implementation of the formula <a href="#equation-decay:exer:dudt:D2t">(1)</a> is to
have a loop over <span class="math">\(i\)</span>. For large <span class="math">\(N_t\)</span>, such loop may run slowly in
Python. A technique for speeding up the computations, called vectorization
or array computing,
replaces the loop by array operations. To see how this can be done in
the present mathematical problem, we
define two arrays</p>
<div class="math">
\[\begin{split}u^+ &amp;= (u^2,u^3,\ldots,u^{N_t}),
u^- &amp;= (u^0,u^1,\ldots,u^{N_t-2})\tp\end{split}\]</div>
<p>The formula <a href="#equation-decay:exer:dudt:D2t">(1)</a> can now be expressed as</p>
<div class="math">
\[(d^1,d^2,\ldots,d^{N_t-1}) = \frac{1}{2\Delta t}(u^+ - u^-)\tp\]</div>
<p>The corresponding Python code reads</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">d</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span> <span class="o">-</span> <span class="n">u</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">dt</span><span class="p">)</span>
<span class="c"># or</span>
<span class="n">d</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="n">N_t</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="n">N_t</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">u</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">N_t</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">dt</span><span class="p">)</span>
</pre></div>
</div>
<p>Recall that an array slice <code class="docutils literal"><span class="pre">u[1:-1]</span></code> contains the elements in <code class="docutils literal"><span class="pre">u</span></code> starting
with index 1 and going all indices up to, but not including, the last one
(<code class="docutils literal"><span class="pre">-1</span></code>).</p>
<p>Use the ideas above to implement a vectorized version of the
<code class="docutils literal"><span class="pre">differentiate</span></code> function without loops. Make a corresponding
test function that compares the result with that of
<code class="docutils literal"><span class="pre">differentiate</span></code>.</p>
<p><strong>Solution.</strong>
Appropriate functions are</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">differentiate_vec</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">dt</span><span class="p">):</span>
    <span class="n">dudt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">u</span><span class="p">))</span>
    <span class="n">dudt</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span> <span class="o">-</span> <span class="n">u</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">dt</span><span class="p">)</span>
    <span class="n">dudt</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">u</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="n">dt</span>
    <span class="n">dudt</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">u</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span><span class="o">/</span><span class="n">dt</span>
    <span class="k">return</span> <span class="n">dudt</span>

<span class="k">def</span> <span class="nf">test_differentiate_vec</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Test differentiate_vec by comparing with differentiate.&quot;&quot;&quot;</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
    <span class="n">u</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="mi">7</span>
    <span class="n">dudt_expected</span> <span class="o">=</span> <span class="n">differentiate</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">dudt_computed</span> <span class="o">=</span> <span class="n">differentiate_vec</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">diff</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">dudt_expected</span> <span class="o">-</span> <span class="n">dudt_computed</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
    <span class="n">tol</span> <span class="o">=</span> <span class="mf">1E-15</span>
    <span class="k">assert</span> <span class="n">diff</span> <span class="o">&lt;</span> <span class="n">tol</span>
</pre></div>
</div>
<p>Filename: <code class="docutils literal"><span class="pre">differentiate</span></code>.</p>
</div>
<div class="section" id="exercise-3-experiment-with-divisions">
<span id="decay-exer-intdiv"></span><h2>Exercise 3: Experiment with divisions<a class="headerlink" href="#exercise-3-experiment-with-divisions" title="Permalink to this headline">¶</a></h2>
<p>Explain what happens in the following computations, where
some are mathematically unexpected:</p>
<div class="highlight-ipy"><div class="highlight"><pre><span class="o">&gt;&gt;&gt;</span> <span class="n">dt</span> <span class="o">=</span> <span class="mi">3</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">T</span> <span class="o">=</span> <span class="mi">8</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">Nt</span> <span class="o">=</span> <span class="n">T</span><span class="o">/</span><span class="n">dt</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">Nt</span>
<span class="mi">2</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">theta</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">1</span>
<span class="o">&gt;&gt;&gt;</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">theta</span><span class="p">)</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="n">dt</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">theta</span><span class="o">*</span><span class="n">dt</span><span class="o">*</span><span class="n">a</span><span class="p">)</span>
<span class="mi">0</span>
</pre></div>
</div>
<p><strong>Solution.</strong>
We add some more investiations of the types and values involved
in the computations:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">dt</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">T</span> <span class="o">=</span> <span class="mi">8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Nt</span> <span class="o">=</span> <span class="n">T</span><span class="o">/</span><span class="n">dt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Nt</span>
<span class="go">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">type</span><span class="p">(</span><span class="n">Nt</span><span class="p">)</span>
<span class="go">&lt;type &#39;int&#39;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">linspace</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">theta</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">theta</span><span class="p">)</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="n">dt</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">theta</span><span class="o">*</span><span class="n">dt</span><span class="o">*</span><span class="n">a</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">theta</span><span class="p">)</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="n">dt</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">theta</span><span class="o">*</span><span class="n">dt</span><span class="o">*</span><span class="n">a</span><span class="p">)</span>
<span class="go">2</span>
</pre></div>
</div>
<p>From this we realize at the unexpected results are caused by
integer division: <code class="docutils literal"><span class="pre">int</span></code> object divided by <code class="docutils literal"><span class="pre">int</span></code> object.
For example,
<code class="docutils literal"><span class="pre">Nt</span></code> is an integer, not a real as we want, because 8/3 according integer
division is 2, not the 2.66666 approximation to <span class="math">\(\frac{8}{3}\)</span>.</p>
<p>Filename: <code class="docutils literal"><span class="pre">pyproblems</span></code>.</p>
</div>
<div class="section" id="exercise-4-experiment-with-wrong-computations">
<span id="decay-exer-decay1err"></span><h2>Exercise 4: Experiment with wrong computations<a class="headerlink" href="#exercise-4-experiment-with-wrong-computations" title="Permalink to this headline">¶</a></h2>
<p>Consider the <code class="docutils literal"><span class="pre">solver</span></code> function in the <a class="reference external" href="http://tinyurl.com/ofkw6kc/alg/decay_v1.py">decay_v1.py</a> file
and the following call:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">u</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="n">solver</span><span class="p">(</span><span class="n">I</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">theta</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>The output becomes</p>
<div class="highlight-text"><div class="highlight"><pre>t= 0.000 u=1
t= 2.000 u=0
t= 4.000 u=0
t= 6.000 u=0
</pre></div>
</div>
<p>Print out the result of all intermediate computations and use
<code class="docutils literal"><span class="pre">type(v)</span></code> to see the object type of the result stored in some variable <code class="docutils literal"><span class="pre">v</span></code>.
Examine the intermediate calculations and explain
why <code class="docutils literal"><span class="pre">u</span></code> is wrong and why we compute up to <span class="math">\(t=6\)</span> only even though we
specified <span class="math">\(T=7\)</span>.</p>
<p><strong>Solution.</strong>
A code for investigating this problem may look as follows.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">solver</span><span class="p">(</span><span class="n">I</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">theta</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Solve u&#39;=-a*u, u(0)=I, for t in (0,T] with steps of dt.&quot;&quot;&quot;</span>
    <span class="n">Nt</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">dt</span><span class="p">)</span>            <span class="c"># no of time intervals</span>
    <span class="n">T</span> <span class="o">=</span> <span class="n">Nt</span><span class="o">*</span><span class="n">dt</span>                 <span class="c"># adjust T to fit time step dt</span>
    <span class="n">u</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">(</span><span class="n">Nt</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>           <span class="c"># array of u[n] values</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">Nt</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>  <span class="c"># time mesh</span>

    <span class="n">u</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">I</span>                  <span class="c"># assign initial condition</span>
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">Nt</span><span class="p">):</span>    <span class="c"># n=0,1,...,Nt-1</span>
        <span class="n">factor1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">theta</span><span class="p">)</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="n">dt</span><span class="p">)</span>
        <span class="n">factor2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">theta</span><span class="o">*</span><span class="n">dt</span><span class="o">*</span><span class="n">a</span><span class="p">)</span>
        <span class="n">factor3</span> <span class="o">=</span> <span class="n">factor1</span><span class="o">/</span><span class="n">factor2</span>
        <span class="k">print</span> <span class="n">factor1</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">factor1</span><span class="p">),</span> <span class="n">factor2</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">factor2</span><span class="p">),</span>
        <span class="k">print</span> <span class="n">factor3</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">factor3</span><span class="p">)</span>
        <span class="n">u</span><span class="p">[</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">theta</span><span class="p">)</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="n">dt</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">theta</span><span class="o">*</span><span class="n">dt</span><span class="o">*</span><span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="n">u</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">u</span><span class="p">,</span> <span class="n">t</span>

<span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="o">*</span>
<span class="n">u</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="n">solver</span><span class="p">(</span><span class="n">I</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">theta</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c"># Write out a table of t and u values:</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)):</span>
    <span class="k">print</span> <span class="s">&#39;t=</span><span class="si">%6.3f</span><span class="s"> u=</span><span class="si">%g</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">u</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="c"># or print &#39;t={t:6.3f} u={u:g}&#39;.format(t=t[i], u=u[i])</span>
</pre></div>
</div>
<p>Running this code show</p>
<div class="highlight-text"><div class="highlight"><pre>Terminal&gt; python decay_v1_err.py
1 &lt;type &#39;int&#39;&gt; 3 &lt;type &#39;int&#39;&gt; 0 &lt;type &#39;int&#39;&gt;
1 &lt;type &#39;int&#39;&gt; 3 &lt;type &#39;int&#39;&gt; 0 &lt;type &#39;int&#39;&gt;
1 &lt;type &#39;int&#39;&gt; 3 &lt;type &#39;int&#39;&gt; 0 &lt;type &#39;int&#39;&gt;
t= 0.000 u=1
t= 2.000 u=0
t= 4.000 u=0
t= 6.000 u=0
</pre></div>
</div>
<p>We realize that we have integer divided by integer in the numerical
formula, i.e., the result of 1/3 is 0 because of integer division.
This fraction is multiplied by <code class="docutils literal"><span class="pre">u[n]</span></code>, but the result remains zero.</p>
<p>Filename: <code class="docutils literal"><span class="pre">decay_v1_err</span></code>.</p>
</div>
<div class="section" id="exercise-5-plot-the-error-function">
<span id="decay-exer-plot-error"></span><h2>Exercise 5: Plot the error function<a class="headerlink" href="#exercise-5-plot-the-error-function" title="Permalink to this headline">¶</a></h2>
<p>Solve the problem <span class="math">\(u'=-au\)</span>, <span class="math">\(u(0)=I\)</span>, using the Forward Euler, Backward
Euler, and Crank-Nicolson schemes. For each scheme, plot the error mesh
function <span class="math">\(e^n = \uex(t_n)-u^n\)</span> for <span class="math">\(\Delta t\)</span>, <span class="math">\(\frac{1}{4}\Delta t\)</span>, and
<span class="math">\(\frac{1}{8}\Delta t\)</span>, where <span class="math">\(\uex\)</span> is the exact solution of the ODE and
<span class="math">\(u^n\)</span> is the numerical solution at mesh point <span class="math">\(t_n\)</span>.</p>
<p><strong>Hint.</strong>
Modify the <a class="reference external" href="http://tinyurl.com/ofkw6kc/alg/decay_plot_mpl.py">decay_plot_mpl.py</a> code.</p>
<p><strong>Solution.</strong>
Looking at the <code class="docutils literal"><span class="pre">decay_plot_mpl.py</span></code> file, we realize that we only
need to change the <code class="docutils literal"><span class="pre">explore</span></code> method such that the error and not
the solutions are plotted. We also need to run a loop over
<span class="math">\(\Delta t\)</span> values and get all the corresponding curves in the same
plot. Quite some editing is necessary. Also the <code class="docutils literal"><span class="pre">main</span></code> function needs
some edits.</p>
<p>The <code class="docutils literal"><span class="pre">solver</span></code> and <code class="docutils literal"><span class="pre">exact_solution</span></code> functions are not altered.
The <code class="docutils literal"><span class="pre">explore</span></code> and <code class="docutils literal"><span class="pre">main</span></code> functions as well as the call to <code class="docutils literal"><span class="pre">main</span></code> are
edited to</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">explore</span><span class="p">(</span><span class="n">I</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">dt_values</span><span class="p">,</span> <span class="n">theta</span><span class="o">=</span><span class="mf">0.5</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Run cases with the solver, compute error measure,</span>
<span class="sd">    and plot the error.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">figure</span><span class="p">()</span> <span class="c"># create new plot</span>
    <span class="k">for</span> <span class="n">dt</span> <span class="ow">in</span> <span class="n">dt_values</span><span class="p">:</span>
        <span class="k">print</span> <span class="s">&#39;dt&#39;</span><span class="p">,</span> <span class="n">dt</span>
        <span class="n">u</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="n">solver</span><span class="p">(</span><span class="n">I</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">theta</span><span class="p">)</span>    <span class="c"># Numerical solution</span>
        <span class="n">u_e</span> <span class="o">=</span> <span class="n">exact_solution</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">I</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
        <span class="n">e</span> <span class="o">=</span> <span class="n">u_e</span> <span class="o">-</span> <span class="n">u</span>
        <span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
        <span class="n">hold</span><span class="p">(</span><span class="s">&#39;on&#39;</span><span class="p">)</span>
    <span class="n">legend</span><span class="p">([</span><span class="s">&#39;dt=</span><span class="si">%g</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">dt</span> <span class="k">for</span> <span class="n">dt</span> <span class="ow">in</span> <span class="n">dt_values</span><span class="p">])</span>
    <span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;t&#39;</span><span class="p">)</span>
    <span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;u&#39;</span><span class="p">)</span>
    <span class="n">title</span><span class="p">(</span><span class="s">&#39;theta=</span><span class="si">%g</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">theta</span><span class="p">)</span>
    <span class="n">theta2name</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="s">&#39;FE&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="s">&#39;BE&#39;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">:</span> <span class="s">&#39;CN&#39;</span><span class="p">}</span>
    <span class="n">savefig</span><span class="p">(</span><span class="s">&#39;</span><span class="si">%s</span><span class="s">_</span><span class="si">%g</span><span class="s">.png&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">theta2name</span><span class="p">[</span><span class="n">theta</span><span class="p">],</span> <span class="n">dt</span><span class="p">))</span>
    <span class="n">savefig</span><span class="p">(</span><span class="s">&#39;</span><span class="si">%s</span><span class="s">_</span><span class="si">%g</span><span class="s">.pdf&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">theta2name</span><span class="p">[</span><span class="n">theta</span><span class="p">],</span> <span class="n">dt</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">(</span><span class="n">I</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">dt_values</span><span class="p">,</span> <span class="n">theta_values</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">)):</span>
    <span class="k">for</span> <span class="n">theta</span> <span class="ow">in</span> <span class="n">theta_values</span><span class="p">:</span>
        <span class="n">explore</span><span class="p">(</span><span class="n">I</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">dt_values</span><span class="p">,</span> <span class="n">theta</span><span class="p">)</span>

<span class="n">dt</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">dt_values</span> <span class="o">=</span> <span class="p">[</span><span class="n">dt</span><span class="p">,</span> <span class="n">dt</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="n">dt</span><span class="o">/</span><span class="mi">8</span><span class="p">]</span>
<span class="n">main</span><span class="p">(</span><span class="n">I</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">dt_values</span><span class="o">=</span><span class="n">dt_values</span><span class="p">)</span>
<span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<div class="figure">
<a class="reference internal image-reference" href="_images/decay_plot_error.png"><img alt="_images/decay_plot_error.png" src="_images/decay_plot_error.png" style="width: 800px;" /></a>
</div>
<p>Filename: <code class="docutils literal"><span class="pre">decay_plot_error</span></code>.</p>
</div>
<div class="section" id="exercise-6-change-formatting-of-numbers-and-debug">
<span id="decay-exer-inexact-output"></span><h2>Exercise 6: Change formatting of numbers and debug<a class="headerlink" href="#exercise-6-change-formatting-of-numbers-and-debug" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference external" href="http://tinyurl.com/ofkw6kc/alg/decay_memsave.py">decay_memsave.py</a> program
writes the time values and solution values to a file which looks
like</p>
<div class="highlight-text"><div class="highlight"><pre>0.0000000000000000E+00  1.0000000000000000E+00
2.0000000000000001E-01  8.3333333333333337E-01
4.0000000000000002E-01  6.9444444444444453E-01
6.0000000000000009E-01  5.7870370370370383E-01
8.0000000000000004E-01  4.8225308641975323E-01
1.0000000000000000E+00  4.0187757201646102E-01
1.2000000000000000E+00  3.3489797668038418E-01
1.3999999999999999E+00  2.7908164723365347E-01
</pre></div>
</div>
<p>Modify the file output such that it looks like</p>
<div class="highlight-text"><div class="highlight"><pre>0.000  1.00000
0.200  0.83333
0.400  0.69444
0.600  0.57870
0.800  0.48225
1.000  0.40188
1.200  0.33490
1.400  0.27908
</pre></div>
</div>
<p>If you have just modified the formatting of numbers in the file,
running the modified program</p>
<div class="highlight-text"><div class="highlight"><pre>Terminal&gt; python decay_memsave_v2.py --T 10 --theta 1 \
          --dt 0.2 --makeplot
</pre></div>
</div>
<p>leads to printing of the message <code class="docutils literal"><span class="pre">Bug</span> <span class="pre">in</span> <span class="pre">the</span> <span class="pre">implementation!</span></code> in the
terminal window. Why?</p>
<p><strong>Solution.</strong>
The new formatting is obtained by replacing the format <code class="docutils literal"><span class="pre">%.16E</span></code> for
<code class="docutils literal"><span class="pre">t</span></code> by <code class="docutils literal"><span class="pre">%.3f</span></code> and the format for <code class="docutils literal"><span class="pre">u</span></code> must be <code class="docutils literal"><span class="pre">%.5f</span></code>.</p>
<p>With only 5 decimals in the file, the <code class="docutils literal"><span class="pre">test_solver_minmem</span></code> function compares
truncated elements <code class="docutils literal"><span class="pre">u</span></code>, accurate only to <span class="math">\(10^{-5}\)</span> with the
exact discrete solution and applies a far too small <code class="docutils literal"><span class="pre">tol</span></code> value.
<code class="docutils literal"><span class="pre">tol</span></code> must be <code class="docutils literal"><span class="pre">1E-4</span></code>.</p>
<p>Filename: <code class="docutils literal"><span class="pre">decay_memsave_v2</span></code>.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <center>
            <p class="logo"><a href="http://cbc.simula.no/" title="Go to Center for Biomedical Computing">
              <img class="logo" src="_static/cbc_logo.png" alt="Logo"/>
            </a></p>
            </center>
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Exercises  (1)</a><ul>
<li><a class="reference internal" href="#exercise-1-define-a-mesh-function-and-visualize-it">Exercise 1: Define a mesh function and visualize it</a><ul>
<li><a class="reference internal" href="#remarks-1">Remarks  (1)</a></li>
</ul>
</li>
<li><a class="reference internal" href="#exercise-2-differentiate-a-function">Exercise 2: Differentiate a function</a></li>
<li><a class="reference internal" href="#exercise-3-experiment-with-divisions">Exercise 3: Experiment with divisions</a></li>
<li><a class="reference internal" href="#exercise-4-experiment-with-wrong-computations">Exercise 4: Experiment with wrong computations</a></li>
<li><a class="reference internal" href="#exercise-5-plot-the-error-function">Exercise 5: Plot the error function</a></li>
<li><a class="reference internal" href="#exercise-6-change-formatting-of-numbers-and-debug">Exercise 6: Change formatting of numbers and debug</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="._book003.html"
                        title="previous chapter">Implementation  (1)</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="._book005.html"
                        title="next chapter">Analysis</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/._book004.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" size="18" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="._book005.html" title="Analysis"
             >next</a> |</li>
        <li class="right" >
          <a href="._book003.html" title="Implementation (1)"
             >previous</a> |</li>
        <li><a href="index.html">Finite Difference Computing with Exponential Decay Models</a> &raquo;</li> 
      </ul>
    </div>
<div class="wrapper">
  <div class="footer">
  <a href="http://cbc.simula.no"><img src="_static/cbc_banner.png" width="100%"><a>
  </div>
</div>

  </body>
</html>
.. !split

Appendix: Useful formulas
%%%%%%%%%%%%%%%%%%%%%%%%%

.. _sec:form:fdop:

Finite difference operator notation
===================================

.. _Eq:Dop:fd1:center:

.. math::

    \tag{393}
    u'(t_n) \approx
        \lbrack D_tu\rbrack^n = \frac{u^{n+\half} - u^{n-\half}}{\Delta t} 
        

.. _Eq:Dop:fd1:center2:

.. math::

    \tag{394}
    u'(t_n) a\approx
        \lbrack D_{2t}u\rbrack^n = \frac{u^{n+1} - u^{n-1}}{2\Delta t} +
        
        

.. _Eq:Dop:fd1:bw:

.. math::

    \tag{395}
    u'(t_n) =
        \lbrack D_t^-u\rbrack^n = \frac{u^{n} - u^{n-1}}{\Delta t}
        
        

.. _Eq:Dop:fd1:fw:

.. math::

    \tag{396}
    u'(t_n) \approx
        \lbrack D_t^+u\rbrack^n = \frac{u^{n+1} - u^{n}}{\Delta t}
        
        

.. _Eq:Dop:fd1:theta:

.. math::

    \tag{397}
    u'(t_{n+\theta}) =
        \lbrack \bar D_tu\rbrack^{n+\theta} = \frac{u^{n+1} - u^{n}}{\Delta t}
        
        

.. _Eq:Dop:fd1:bw2:

.. math::

    \tag{398}
    u'(t_n) \approx
        \lbrack D_t^{2-}u\rbrack^n = \frac{3u^{n} - 4u^{n-1} + u^{n-2}}{2\Delta t}
        
        

.. _Eq:Dop:fd2:center:

.. math::

    \tag{399}
    u''(t_n) \approx
        \lbrack D_tD_t u\rbrack^n = \frac{u^{n+1} - 2u^{n} + u^{n-1}}{\Delta t^2}
        
        

.. _Eq:Dop:avg:arith:

.. math::

    \tag{400}
    u(t_{n+\half}) \approx \lbrack \overline{u}^{t}\rbrack^{n+\half}
        = \half(u^{n+1} + u^n)
        
        

.. _Eq:Dop:avg:geom:

.. math::

    \tag{401}
    u(t_{n+\half})^2 \approx \lbrack \overline{u^2}^{t,g}\rbrack^{n+\half}
        = u^{n+1}u^n
        
        

.. _Eq:Dop:avg:harm:

.. math::

    \tag{402}
    u(t_{n+\half}) \approx \lbrack \overline{u}^{t,h}\rbrack^{n+\half}
        = 2\frac{\frac{1}{u^{n+1}} + \frac{1}{u^n}}
        
        

.. _Eq:Dop:avg:theta:

.. math::

    \tag{403}
    u(t_{n+\theta}) \approx \lbrack \overline{u}^{t,\theta}\rbrack^{n+\theta}
        = \theta u^{n+1} + (1-\theta)u^n ,\quad t_{n+\theta}=\theta t_{n+1} + (1-\theta)t_{n-1}
        
        

.. _sec:form:truncerr:

Truncation errors of finite difference approximations
=====================================================

.. math::
        
        \uex'(t_n) =
        [D_t\uex]^n + R^n = \frac{\uex^{n+\half} - \uex^{n-\half}}{\Delta t} +R^n\nonumber,
        

.. _Eq:form:trunc:fd1:center:

.. math::

    \tag{404}
    R^n = -\frac{1}{24}\uex'''(t_n)\Delta t^2 + {\cal O}(\Delta t^4)
        
        

.. math::
          
        \uex'(t_n) =
        [D_{2t}\uex]^n +R^n = \frac{\uex^{n+1} - \uex^{n-1}}{2\Delta t} +
        R^n\nonumber,
        

.. _Eq:form:trunc:fd1:center2:

.. math::

    \tag{405}
    R^n = -\frac{1}{6}\uex'''(t_n)\Delta t^2 + {\cal O}(\Delta t^4)
        
        

.. math::
          
        \uex'(t_n) =
        [D_t^-\uex]^n +R^n = \frac{\uex^{n} - \uex^{n-1}}{\Delta t}
        +R^n\nonumber,
        

.. _Eq:form:trunc:fd1:bw:

.. math::

    \tag{406}
    R^n = -\half\uex''(t_n)\Delta t + {\cal O}(\Delta t^2)
        
        

.. math::
          
        \uex'(t_n) =
        [D_t^+\uex]^n +R^n = \frac{\uex^{n+1} - \uex^{n}}{\Delta t}
        +R^n\nonumber,
        

.. _Eq:form:trunc:fd1:fw:

.. math::

    \tag{407}
    R^n = -\half\uex''(t_n)\Delta t + {\cal O}(\Delta t^2)
        
        

.. math::
          
        \uex'(t_{n+\theta}) =
        [\bar D_t\uex]^{n+\theta} +R^{n+\theta} = \frac{\uex^{n+1} - \uex^{n}}{\Delta t}
        +R^{n+\theta}\nonumber,
        

.. math::
          
        R^{n+\theta} = -\half(1-2\theta)\uex''(t_{n+\theta})\Delta t +
        \frac{1}{6}((1 - \theta)^3 - \theta^3)\uex'''(t_{n+\theta})\Delta t^2 +
        \nonumber
        

.. _Eq:form:trunc:fd1:theta:

.. math::

    \tag{408}
    \quad {\cal O}(\Delta t^3)
        
        

.. math::
          
        \uex'(t_n) =
        [D_t^{2-}\uex]^n +R^n = \frac{3\uex^{n} - 4\uex^{n-1} + \uex^{n-2}}{2\Delta t}
        +R^n\nonumber,
        

.. _Eq:form:trunc:fd1:bw2:

.. math::

    \tag{409}
    R^n = \frac{1}{3}\uex'''(t_n)\Delta t^2 + {\cal O}(\Delta t^3)
        
        

.. math::
          
        \uex''(t_n) =
        [D_tD_t \uex]^n +R^n = \frac{\uex^{n+1} - 2\uex^{n} + \uex^{n-1}}{\Delta t^2}
        +R^n\nonumber,
        

.. _Eq:form:trunc:fd2:center:

.. math::

    \tag{410}
    R^n = -\frac{1}{12}\uex''''(t_n)\Delta t^2 + {\cal O}(\Delta t^4)
        
        

.. math::
        
        \uex(t_{n+\theta}) = [\overline{\uex}^{t,\theta}]^{n+\theta} +R^{n+\theta}
        = \theta \uex^{n+1} + (1-\theta)\uex^n +R^{n+\theta},\nonumber
        

.. _Eq:form:trunc:avg:theta:

.. math::

    \tag{411}
    R^{n+\theta} = -\half\uex''(t_{n+\theta})\Delta t^2\theta (1-\theta) +
        {\cal O}(\Delta t^3)
        \tp
        
        

.. _sec:form:fdexp:

Finite differences of exponential functions
===========================================

Complex exponentials
~~~~~~~~~~~~~~~~~~~~

Let :math:`u^n = \exp{(i\omega n\Delta t)} = e^{i\omega t}`.

.. _Eq:form:exp:fd2:center:

.. math::

    \tag{412}
    [D_tD_t u]^n = u^n \frac{2}{\Delta t}(\cos \omega\Delta t - 1) =
        -\frac{4}{\Delta t}\sin^2\left(\frac{\omega\Delta t}{2}\right),
        
        

.. _Eq:form:exp:fd1:fw:

.. math::

    \tag{413}
    [D_t^+ u]^n = u^n\frac{1}{\Delta t}(\exp{(i\omega\Delta t)} - 1),
        
        

.. _Eq:form:exp:fd1:bw:

.. math::

    \tag{414}
    [D_t^- u]^n = u^n\frac{1}{\Delta t}(1 - \exp{(-i\omega\Delta t)}),
        
        

.. _Eq:form:exp:fd1:center:

.. math::

    \tag{415}
    [D_t u]^n = u^n\frac{2}{\Delta t}i\sin{\left(\frac{\omega\Delta t}{2}\right)},
        
        

.. _Eq:form:exp:fd1c:center:

.. math::

    \tag{416}
    [D_{2t} u]^n = u^n\frac{1}{\Delta t}i\sin{(\omega\Delta t)}
        
        \tp
        

Real exponentials
~~~~~~~~~~~~~~~~~

Let :math:`u^n = \exp{(\omega n\Delta t)} = e^{\omega t}`.

.. _Eq:form:rexp:fd2:center:

.. math::

    \tag{417}
    [D_tD_t u]^n = u^n \frac{2}{\Delta t}(\cos \omega\Delta t - 1) =
        -\frac{4}{\Delta t}\sin^2\left(\frac{\omega\Delta t}{2}\right),
        
        

.. _Eq:form:rexp:fd1:fw:

.. math::

    \tag{418}
    [D_t^+ u]^n = u^n\frac{1}{\Delta t}(\exp{(i\omega\Delta t)} - 1),
        
        

.. _Eq:form:rexp:fd1:bw:

.. math::

    \tag{419}
    [D_t^- u]^n = u^n\frac{1}{\Delta t}(1 - \exp{(-i\omega\Delta t)}),
        
        

.. _Eq:form:rexp:fd1:center:

.. math::

    \tag{420}
    [D_t u]^n = u^n\frac{2}{\Delta t}i\sin{\left(\frac{\omega\Delta t}{2}\right)},
        
        

.. _Eq:form:rexp:fd1c:center:

.. math::

    \tag{421}
    [D_{2t} u]^n = u^n\frac{1}{\Delta t}i\sin{(\omega\Delta t)}
        
        \tp
        

.. _sec:form:fdtn:

Finite differences of :math:`t^n`
=================================

The following results are useful when checking if a polynomial term in a
solution fulfills the discrete equation for the numerical method.

.. _Eq:form:Dop:tn:fw:

.. math::

    \tag{422}
    \lbrack D_t^+ t\rbrack^n = 1,
        
        

.. _Eq:form:Dop:tn:bw:

.. math::

    \tag{423}
    \lbrack D_t^- t\rbrack^n = 1,
        
        

.. math::
          
        \lbrack D_t t\rbrack^n = 1,
        
        \lbrack D_{2t} t\rbrack^n = 1,
        
        \lbrack D_{t}D_t t\rbrack^n = 0
        
        \tp
        

The next formulas concern the action of difference operators on a :math:`t^2` term.

.. _Eq:form:Dop:tn2:fw:

.. math::

    \tag{424}
    \lbrack D_t^+ t^2\rbrack^n = (2n+1)\Delta t,
        
        

.. _Eq:form:Dop:tn2:bw:

.. math::

    \tag{425}
    \lbrack D_t^- t^2\rbrack^n = (2n-1)\Delta t,
        
        

.. math::
          
        \lbrack D_t t^2\rbrack^n = 2n\Delta t,
        
        \lbrack D_{2t} t^2\rbrack^n = 2n\Delta t,
        
        \lbrack D_{t}D_t t^2\rbrack^n = 2,
        
        

Finally, we present formulas for a :math:`t^3` term: **These must be controlled**
against ``lib.py``. Use :math:`t_n` instead of :math:`n\Delta t`??

.. _Eq:form:Dop:tn3:fw:

.. math::

    \tag{426}
    \lbrack D_t^+ t^3\rbrack^n = 3(n\Delta t)^2 + 3n\Delta t^2 + \Delta t^2,
        
        

.. _Eq:form:Dop:tn3:bw:

.. math::

    \tag{427}
    \lbrack D_t^- t^3\rbrack^n = 3(n\Delta t)^2 - 3n\Delta t^2 + \Delta t^2,
        
        

.. _Eq:form:Dop:tn3:cn:

.. math::

    \tag{428}
    \lbrack D_t t^3\rbrack^n = 3(n\Delta t)^2 + \frac{1}{4}\Delta t^2,
        
        

.. _Eq:form:Dop:tn3:2cn:

.. math::

    \tag{429}
    \lbrack D_{2t} t^3\rbrack^n = 3(n\Delta t)^2 + \Delta t^2,
        
        

.. _Eq:form:Dop2:tn3:cn:

.. math::

    \tag{430}
    \lbrack D_{t}D_t t^3\rbrack^n = 6n\Delta t,
        
        

